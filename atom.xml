<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LittlePig&#39;s Blog</title>
  
  
  <link href="https://www.forchanchan.cn/atom.xml" rel="self"/>
  
  <link href="https://www.forchanchan.cn/"/>
  <updated>2021-01-18T02:12:08.680Z</updated>
  <id>https://www.forchanchan.cn/</id>
  
  <author>
    <name>LittlePig</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Zookeeper的Watch机制分析</title>
    <link href="https://www.forchanchan.cn/zookeeper-watch.html"/>
    <id>https://www.forchanchan.cn/zookeeper-watch.html</id>
    <published>2021-01-18T02:11:00.000Z</published>
    <updated>2021-01-18T02:12:08.680Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Watch机制的底层原理"><a href="#Watch机制的底层原理" class="headerlink" title="Watch机制的底层原理"></a>Watch机制的底层原理</h4><p>​    <strong>在 ZooKeeper 中则是在客户端和服务器端分别实现两个存放观察者列表，即：ZKWatchManager 和 WatchManager</strong>。其核心操作就是围绕着这两个展开的：</p><ol><li><p>客户端Watch注册实现过程</p><p>在发送一个 Watch 监控事件的会话请求时，ZooKeeper 客户端主要做了两个工作：</p><ul><li>标记该会话是一个带有Watch事件的请求</li><li>将Watch事件存储到ZKWatchManager</li></ul><p>以 getData 接口为例。<em>当发送一个带有 Watch 事件的请求时，客户端首先会把该会话标记为带有 Watch 监控的事件请求，之后通过 DataWatchRegistration 类来保存 watcher 事件和节点的对应关系</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">byte</span>[] getData(<span class="keyword">final</span> String path, Watcher watcher, Stat stat)&#123;</span><br><span class="line">  ...</span><br><span class="line">  WatchRegistration wcb = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (watcher != <span class="keyword">null</span>) &#123;</span><br><span class="line">    wcb = <span class="keyword">new</span> DataWatchRegistration(watcher, clientPath); <span class="comment">//封装watch事件与节点的关系</span></span><br><span class="line">  &#125;</span><br><span class="line">  RequestHeader h = <span class="keyword">new</span> RequestHeader();</span><br><span class="line">  request.setWatch(watcher != <span class="keyword">null</span>); <span class="comment">//标记带有watch事件的请求</span></span><br><span class="line">  ...</span><br><span class="line">  GetDataResponse response = <span class="keyword">new</span> GetDataResponse();</span><br><span class="line">  ReplyHeader r = cnxn.submitRequest(h, request, response, wcb); <span class="comment">//发送请求</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><em>之后客户端向服务器发送请求时，是将请求封装成一个 Packet 对象，并添加到一个等待发送队列 outgoingQueue 中</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Packet <span class="title">queuePacket</span><span class="params">(RequestHeader h, ReplyHeader r，...)</span> </span>&#123;</span><br><span class="line">    Packet packet = <span class="keyword">null</span>;</span><br><span class="line">    ...</span><br><span class="line">    packet = <span class="keyword">new</span> Packet(h, r, request, response, watchRegistration); <span class="comment">//封装为Packet对象</span></span><br><span class="line">    ...</span><br><span class="line">    outgoingQueue.add(packet);  <span class="comment">//添加到等待发送队列</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> packet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>最后，ZooKeeper 客户端就会向服务器端发送这个请求，完成请求发送后。调用负责处理服务器响应的 SendThread 线程类中的 readResponse 方法接收服务端的回调，并在最后执行 finishPacket（）方法将 Watch 注册到 ZKWatchManager 中</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">finishPacket</span><span class="params">(Packet p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> err = p.replyHeader.getErr();</span><br><span class="line">        <span class="keyword">if</span> (p.watchRegistration != <span class="keyword">null</span>) &#123;</span><br><span class="line">            p.watchRegistration.register(err); <span class="comment">//将watch注册到客户端的ZKWatchManager中</span></span><br><span class="line">        &#125;</span><br><span class="line">       ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>服务端Watch注册实现过程</p><p>Zookeeper 服务端处理 Watch 事件基本有 2 个过程：</p><ul><li>解析收到的请求是否带有Watch注册事件</li><li>将对应的Watch事件存储到WatchManager</li></ul><p><em>当 ZooKeeper 服务器接收到一个客户端请求后，首先会对请求进行解析，判断该请求是否包含 Watch 事件。这在 ZooKeeper 底层是通过 FinalRequestProcessor 类中的 processRequest 函数实现的。当 getDataRequest.getWatch() 值为 True 时，表明该请求需要进行 Watch 监控注册。并通过 zks.getZKDatabase().getData 函数将 Watch 事件注册到服务端的 WatchManager 中</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processRequest</span><span class="params">(Request request)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">byte</span> b[] = zks.getZKDatabase().getData(getDataRequest.getPath(), stat,</span><br><span class="line">        getDataRequest.getWatch() ? cnxn : <span class="keyword">null</span>); <span class="comment">//判断是否有watch事件，有则注册到服务端的WatchManager</span></span><br><span class="line">rsp = <span class="keyword">new</span> GetDataResponse(b, stat);</span><br><span class="line">..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>服务端Watch事件的触发过程</p><p>在客户端和服务端都对 watch 注册完成后，我们接下来看一下在 ZooKeeper 中触发一个 Watch 事件的底层实现过程：</p><p>以 setData 接口即“节点数据内容发生变更”事件为例。<em>在 setData 方法内部执行完对节点数据的变更后，会调用 WatchManager.triggerWatch 方法触发数据变更事件</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Stat <span class="title">setData</span><span class="params">(String path, <span class="keyword">byte</span> data[], ...)</span></span>&#123;</span><br><span class="line">        Stat s = <span class="keyword">new</span> Stat();</span><br><span class="line">        DataNode n = nodes.get(path);</span><br><span class="line">        ... <span class="comment">//变更节点数据</span></span><br><span class="line">        dataWatches.triggerWatch(path, EventType.NodeDataChanged); <span class="comment">//变更完成后触发变更事件</span></span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>进入 triggerWatch 函数内部来看看他究竟做了哪些工作。<em>首先，封装了一个具有会话状态、事件类型、数据节点 3 种属性的 WatchedEvent 对象。之后查询该节点注册的 Watch 事件，如果为空说明该节点没有注册过 Watch 事件。如果存在 Watch 事件则添加到定义的 Wathcers 集合中，并在 WatchManager 管理中删除。最后，通过调用 process 方法向客户端发送通知</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Set&lt;Watcher&gt; <span class="title">triggerWatch</span><span class="params">(String path, EventType type...)</span> </span>&#123;</span><br><span class="line">        WatchedEvent e = <span class="keyword">new</span> WatchedEvent(type,</span><br><span class="line">                KeeperState.SyncConnected, path);  <span class="comment">//封装会话状态，事件类型，数据节点为WatchedEvent对象</span></span><br><span class="line">        Set&lt;Watcher&gt; watchers;  <span class="comment">//待处理的事件集合</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            watchers = watchTable.remove(path);  <span class="comment">//移除该数据节点涉及的所有事件</span></span><br><span class="line">            ...</span><br><span class="line">            <span class="keyword">for</span> (Watcher w : watchers) &#123; <span class="comment">//移除事件到该数据节点之间的映射关系</span></span><br><span class="line">                Set&lt;String&gt; paths = watch2Paths.get(w);  <span class="comment">//该事件可能监听的所有数据节点</span></span><br><span class="line">                <span class="keyword">if</span> (paths != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    paths.remove(path); <span class="comment">//移除掉该数据节点</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//处理该节点的所有事件</span></span><br><span class="line">        <span class="keyword">for</span> (Watcher w : watchers) &#123;</span><br><span class="line">            <span class="keyword">if</span> (supress != <span class="keyword">null</span> &amp;&amp; supress.contains(w)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            w.process(e); <span class="comment">//向客户端发送通知</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> watchers;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>客户端回调的处理过程</p><p><em>客户端使用 SendThread.readResponse() 方法来统一处理服务端的相应。首先反序列化服务器发送请求头信息 replyHdr.deserialize(bbia, “header”)，并判断相属性字段 xid 的值为 -1，表示该请求响应为通知类型。在处理通知类型时，首先将己收到的字节流反序列化转换成 WatcherEvent 对象。接着判断客户端是否配置了 chrootPath 属性，如果为 True 说明客户端配置了 chrootPath 属性。需要对接收到的节点路径进行 chrootPath 处理。最后调用 eventThread.queueEvent( ）方法将接收到的事件交给 EventThread 线程进行处理</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (replyHdr.getXid() == -<span class="number">1</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">    WatcherEvent event = <span class="keyword">new</span> WatcherEvent();</span><br><span class="line">    event.deserialize(bbia, <span class="string">&quot;response&quot;</span>); <span class="comment">//将收到的字节流反序列化为WatcherEvent对象</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (chrootPath != <span class="keyword">null</span>) &#123;  <span class="comment">//进行chrootPath处理</span></span><br><span class="line">        String serverPath = event.getPath();</span><br><span class="line">        <span class="keyword">if</span>(serverPath.compareTo(chrootPath)==<span class="number">0</span>)</span><br><span class="line">            event.setPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">            ...</span><br><span class="line">            event.setPath(serverPath.substring(chrootPath.length()));</span><br><span class="line">            ...</span><br><span class="line">    &#125;</span><br><span class="line">    WatchedEvent we = <span class="keyword">new</span> WatchedEvent(event);</span><br><span class="line">    ...</span><br><span class="line">    eventThread.queueEvent( we );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看一下 EventThread.queueEvent() 方法内部的执行逻辑。其主要工作分为 2 点：<br><em>第 1 步按照通知的事件类型，从 ZKWatchManager 中查询注册过的客户端 Watch 信息。客户端在查询到对应的 Watch 信息后，会将其从 ZKWatchManager 的管理中删除。因此这里也请你多注意，客户端的 Watcher 机制是一次性的，触发后就会被删除</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;Watcher&gt; <span class="title">materialize</span><span class="params">(...)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Set&lt;Watcher&gt; result = <span class="keyword">new</span> HashSet&lt;Watcher&gt;();</span><br><span class="line">...</span><br><span class="line"><span class="keyword">switch</span> (type) &#123; <span class="comment">//判断通知是什么类型</span></span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">case</span> NodeDataChanged:</span><br><span class="line"><span class="keyword">case</span> NodeCreated:</span><br><span class="line">    <span class="keyword">synchronized</span> (dataWatches) &#123; <span class="comment">//查询watch信息，并从ZKWatchManager中删除</span></span><br><span class="line">        addTo(dataWatches.remove(clientPath), result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">synchronized</span> (existWatches) &#123;</span><br><span class="line">        addTo(existWatches.remove(clientPath), result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>完成了第 1 步工作获取到对应的 Watcher 信息后，将查询到的 Watcher 存储到 waitingEvents 队列中，调用 EventThread 类中的 run 方法会循环取出在 waitingEvents 队列中等待的 Watcher 事件进行处理</em>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  isRunning = <span class="keyword">true</span>;</span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">     Object event = waitingEvents.take(); <span class="comment">//处理watcher事件</span></span><br><span class="line">     <span class="keyword">if</span> (event == eventOfDeath) &#123;</span><br><span class="line">        wasKilled = <span class="keyword">true</span>;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        processEvent(event);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span> (wasKilled)</span><br><span class="line">        <span class="keyword">synchronized</span> (waitingEvents) &#123;</span><br><span class="line">           <span class="keyword">if</span> (waitingEvents.isEmpty()) &#123;</span><br><span class="line">              isRunning = <span class="keyword">false</span>;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">     ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><em>最后调用 processEvent(event) 方法来最终执行实现了 Watcher 接口的 process（）方法：</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">processEvent</span><span class="params">(Object event)</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> (event <span class="keyword">instanceof</span> WatcherSetEventPair) &#123;</span><br><span class="line">      </span><br><span class="line">      WatcherSetEventPair pair = (WatcherSetEventPair) event;</span><br><span class="line">      <span class="keyword">for</span> (Watcher watcher : pair.watchers) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              watcher.process(pair.event);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">              LOG.error(<span class="string">&quot;Error while calling watcher &quot;</span>, t);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ZooKeeper 实现的方式是通过客服端和服务端分别创建有观察者的信息列表。客户端调用 getData、exist 等接口时，首先将对应的 Watch 事件放到本地的 ZKWatchManager 中进行管理。服务端在接收到客户端的请求后根据请求类型判断是否含有 Watch 事件，并将对应事件放到 WatchManager 中进行管理。<br>在事件触发的时候服务端通过节点的路径信息查询相应的 Watch 事件通知给客户端，客户端在接收到通知后，首先查询本地的 ZKWatchManager 获得对应的 Watch 信息处理回调操作。这种设计不但实现了一个分布式环境下的观察者模式，而且通过将客户端和服务端各自处理 Watch 事件所需要的额外信息分别保存在两端，减少彼此通信的内容。大大提升了服务的处理性能。</p></li></ol><p><strong>ZooKeeper Watcher</strong> <strong>特性总结</strong></p><ul><li><p><strong>注册只能确保一次消费</strong></p><p><em>无论是服务端还是客户端，一旦一个</em> <em>Watcher</em> <em>被触发，ZooKeeper</em> <em>都会将其从相应的存储中移除。因此，开发人员在</em> <em>Watcher</em> <em>的使用上要记住的一点是需要反复注册。这样的设计有效地减轻了服务端的压力。如果注册一个</em> <em>Watcher</em> <em>之后一直有效，那么针对那些更新非常频繁的节点，服务端会不断地向客户端发送事件通知，这无论对于网络还是服务端性能的影响都非常大。</em></p></li><li><p><strong>客户端串行执行</strong></p><p><em>客户端</em> <em>Watcher</em> <em>回调的过程是一个串行同步的过程，这为我们保证了顺序，同时，需要开发人员注意的一点是，千万不要因为一个</em> <em>Watcher</em> <em>的处理逻辑影响了整个客户端的</em> <em>Watcher</em> <em>回调。</em></p></li><li><p><strong>轻量级设计</strong></p><p><em>WatchedEvent</em> <em>是</em> <em>ZooKeeper</em> <em>整个</em> <em>Watcher</em> <em>通知机制的最小通知单元，这个数据结构中只包含三部分的内容：通知状态、事件类型和节点路径。也就是说，**Watcher</em> <em>通知非常简单，只会告诉客户端发生了事件，而不会说明事件的具体内容。例如针对</em> <em>NodeDataChanged</em> <em>事件，**ZooKeeper</em> <em>的</em> <em>Watcher</em> <em>只会通知客户指定数据节点的数据内容发生了变更，而对于原始数据以及变更后的新数据都无法从这个事件中直接获取到，而是需要客户端主动重新去获取数据，这也是</em> <em>ZooKeeper</em> <em>的</em> <em>Watcher</em> <em>机制的一个非常重要的特性。另外，客户端向服务端注册</em> <em>Watcher</em> <em>的时候，并不会把客户端真实的</em> <em>Watcher</em> <em>对象传递到服务端，仅仅只是在客户端请求中使用</em> <em>boolean</em> <em>类型属性进行了标记，**同时服务端也仅仅只是保存了当前连接的</em> <em>ServerCnxn</em> <em>对象。这样轻量级的</em> <em>Watcher</em> <em>机制设计，在网络开销和服务端内存开销上都是非常廉价的。</em></p></li></ul><blockquote><p>参考来源：<a href="https://blog.csdn.net/qq_41030039/article/details/106221177">https://blog.csdn.net/qq_41030039/article/details/106221177</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;Watch机制的底层原理&quot;&gt;&lt;a href=&quot;#Watch机制的底层原理&quot; class=&quot;headerlink&quot; title=&quot;Watch机制的底层原理&quot;&gt;&lt;/a&gt;Watch机制的底层原理&lt;/h4&gt;&lt;p&gt;​    &lt;strong&gt;在 ZooKeeper 中则是在客</summary>
      
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Zookeeper应用场景</title>
    <link href="https://www.forchanchan.cn/zookeeper-scene.html"/>
    <id>https://www.forchanchan.cn/zookeeper-scene.html</id>
    <published>2021-01-15T02:06:00.000Z</published>
    <updated>2021-01-15T02:11:44.799Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-数据发布与订阅"><a href="#1-数据发布与订阅" class="headerlink" title="1. 数据发布与订阅"></a>1. 数据发布与订阅</h4><p>​    数据发布/订阅系统，即配置中心。需要发布者将数据发布到Zookeeper的节点上，供订阅者进行数据订阅，进而达到动态获取数据的目的，实现配置信息的集中式管理和数据的动态更新。发布/订阅一般有两种设计模式：推模式和拉模式，服务端主动将数据更新发送给所有订阅的客户端称为推模式；客户端主动请求获取最新数据称为拉模式，Zookeeper采用了推拉相结合的模式，客户端向服务端注册自己需要关注的节点，一旦该节点数据发生变更，那么服务端就会向相应的客户端推送Watcher事件通知，客户端接收到此通知后，主动到服务端获取最新的数据。</p><a id="more"></a><p>　若将配置信息存放到Zookeeper上进行集中管理，在通常情况下，应用在启动时会主动到Zookeeper服务端上进行一次配置信息的获取，同时，在指定节点上注册一个Watcher监听，这样在配置信息发生变更，服务端都会实时通知所有订阅的客户端，从而达到实时获取最新配置的目的。</p><h4 id="2-负载均衡"><a href="#2-负载均衡" class="headerlink" title="2. 负载均衡"></a>2. 负载均衡</h4><p>　负载均衡是一种相当常见的计算机网络技术，用来对多个计算机、网络连接、CPU、磁盘驱动或其他资源进行分配负载，以达到优化资源使用、最大化吞吐率、最小化响应时间和避免过载的目的。</p><p>　　使用Zookeeper实现动态DNS服务</p><p>　　<strong>· 域名配置</strong>，首先在Zookeeper上创建一个节点来进行域名配置，如DDNS/app1/<a href="http://server.app1.company1.com/">server.app1.company1.com</a>。</p><p>　　<strong>· 域名解析</strong>，应用首先从域名节点中获取IP地址和端口的配置，进行自行解析。同时，应用程序还会在域名节点上注册一个数据变更Watcher监听，以便及时收到域名变更的通知。</p><p>　　<strong>· 域名变更</strong>，若发生IP或端口号变更，此时需要进行域名变更操作，此时，只需要对指定的域名节点进行更新操作，Zookeeper就会向订阅的客户端发送这个事件通知，客户端之后就再次进行域名配置的获取。</p><h4 id="3-命名服务"><a href="#3-命名服务" class="headerlink" title="3. 命名服务"></a>3. 命名服务</h4><p>命名服务是分步实现系统中较为常见的一类场景，分布式系统中，被命名的实体通常可以是集群中的机器、提供的服务地址或远程对象等，通过命名服务，客户端可以根据指定名字来获取资源的实体、服务地址和提供者的信息。Zookeeper也可帮助应用系统通过资源引用的方式来实现对资源的定位和使用，广义上的命名服务的资源定位都不是真正意义上的实体资源，在分布式环境中，上层应用仅仅需要一个全局唯一的名字。Zookeeper可以实现一套分布式全局唯一ID的分配机制。</p><p>　　通过调用Zookeeper节点创建的API接口就可以创建一个顺序节点，并且在API返回值中会返回这个节点的完整名字，利用此特性，可以生成全局ID，其步骤如下</p><p>　　1. 客户端根据任务类型，在指定类型的任务下通过调用接口创建一个顺序节点，如”job-“。</p><p>　　2. 创建完成后，会返回一个完整的节点名，如”job-00000001”。</p><p>　　3. 客户端拼接type类型和返回值后，就可以作为全局唯一ID了，如”type2-job-00000001”。</p><h4 id="4-分布式协调与通知"><a href="#4-分布式协调与通知" class="headerlink" title="4. 分布式协调与通知"></a>4. 分布式协调与通知</h4><p>​    Zookeeper中特有的Watcher注册于异步通知机制，能够很好地实现分布式环境下不同机器，甚至不同系统之间的协调与通知，从而实现对数据变更的实时处理。通常的做法是不同的客户端都对Zookeeper上的同一个数据节点进行Watcher注册，监听数据节点的变化（包括节点本身和子节点），若数据节点发生变化，那么所有订阅的客户端都能够接收到相应的Watcher通知，并作出相应处理。</p><p>　　MySQL数据复制总线是一个实时的数据复制框架，用于在不同的MySQL数据库实例之间进行异步数据复制和数据变化通知，整个系统由MySQL数据库集群、消息队列系统、任务管理监控平台、Zookeeper集群等组件共同构成的一个包含生产者、复制管道、数据消费等部分的数据总线系统。</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　Zookeeper主要负责进行分布式协调工作，在具体的实现上，根据功能将数据复制组件划分为三个模块：Core（实现数据复制核心逻辑，将数据复制封装成管道，并抽象出生产者和消费者概念）、Server（启动和停止复制任务）、Monitor（监控任务的运行状态，若数据复制期间发生异常或出现故障则进行告警）</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　每个模块作为独立的进程运行在服务端，运行时的数据和配置信息均保存在Zookeeper上。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfYAAAGfCAIAAAAicmd5AAAgAElEQVR4Ae2dv28USfr/16cNCDa8ACHE8cPB/gUECNAtAXZ2yQaYyBGSHSOTEHwDEiyky4xERHKLg/0DsAMvMhYBfwP2IoQQwQUfnVa6DVbi+4JnKdf1jMcz0z3tmulXB0111VNPPfUq+901TzfjuU+fPn3jIQEJSEACs0jgL7M4KeckAQlIQAKfCSjx/hxIQAISmFkCSvzMLq0Tk4AEJKDE+zMgAQlIYGYJKPEzu7ROTAISkIAS78+ABCQggZkl8G2a2dzcXCpb6AgBX5ntyEI7zc4SOJR4EPgL36mfA2/qnVpuJ9tNAiZqurnuzloCEugEASW+E8vsJCUggW4SUOK7ue7OWgIS6AQBJb4Ty+wkJSCBbhJQ4ru57s5aAhLoBIG6El/IWxl7e3tEsr6+3v6ira6uMvTBwUEMfYKRtD93R5SABAon8D8vTY4a6+bm5srKyqi9GrdH2e/du9e422Eczs/P7+/vD2OpjQQkIIH2CdTaxe/u7t6+fbv9oCsjrq2tvXz5slLZzuWbN28qN7mrV6/y3wsIqWYAfDio6cHuEpCABGpJ/OPHj1E0ITZOgLQPbBt3q0MJSKBrBMaX+EKyNDO5YDdv3pzJeTkpCUigZQLjS/zTp09TliY9ciQtzrNHjsgzxLPHqImJRTnOtFLJjjUuyWvnNouLizTlT1CTJfbcYBgiPIyKLIKkb4SdhojLCIaxkltqYqxo4py3JrMoxJSTz6hMHdMco545piaGoDLmGPn9aEpj5cZMPzxwpowl55hX+EmtFiQggU4TIHEcBxS+Fof699KlS2FHIQguLCw8fPiQykhPc8nBZSTKqQx7KrFHxeIyDMKSMoVnz55FJWbhkEsqucQVZY4YMV3GEMk4bPqeY3S6x0AEH4FRiHHpFTMiwhgUY2pShDF0ch6TjekQQLSmSEKsI84o4yr64jCVo2MKIIJMQ1CIgKMmRowhohyt1NCRI+84oEyvAa02SUACM0Dg8Jd8pF94xCiUMRCE0CSF6hXcXKHoUrlElZJY05TKFJJWUp/KeKBcsawYDFib6Jt7I/JcGSP+mGDoct6KcT5WzD0knkGjb3JOx15QERtNHFHu7cUQaQqVIainlSMGjXjyUVLHwQU8DDawVQISmHYCYyZq8izNF7X5fLp8+XIqDy6ggFtbWylRw3sp6bEtG9tr166RlMADlfFqSuQlrly5MtjtSK25N14NIp6UMyEAXKUMCeWLFy8m57du3aK8s7OTao4q4AG3169fTwYbGxv8xMTl8y8HZRIsMWIyqxS2t7epyWMI0f/555+TZT5KqrQgAQl0nMA4Eo9y5aI8BsEQ7gcPHtAXnbpz505yEnIWgpsy1+/evcPgzJkzyazZAjPq3QWjwDVH+fDhAx4i+L6uIr1OU+zi+9pQGZ8k8tbz58/nl5YlIAEJ9CUwjsS/fv06F+W+fo+tRFJjI8//WsrfImevGp+M8IC0JZXnMhTzWM/jGYz6kmK+pz5qxLgnPXnypK8BU+NOyWTz6fe1jMr8U0XUnDt3boC9TRKQgATGkXiyNHmWYzyId+/epSMJisg5JCeRouES7SOfg8ojbaFlr169SmbNFpaXl3FIoiZ3myLJKylHfim9TVRpzS+5DZB3Ygr5Wy4knfDAQf2Qd8retMzbt28ZKFJG+YiWJSABCeQERpb4vlma2GCmXfb79+8ZI2SIQrSyY80HRv5CuSpaydY+F0QkEku0jAL7fZQxnCTncRnqX6nMh8vLYRZBRn34p5zS8RRC98OAPX4amnoek6aHB5FZSnOvRMLtEA90T57v379P39jgp4R+5Kyw5AYArviIQCHuB2TwaUrTpx6H3P+o5IhE0IB0UJh5loAEukggsiKcmXwqDyigLBy5AeKbwNGU78qRwkqWma1r6ks5vVKSKuker4iEz1RPIR8oyjinvjJi3qW3zIgpWjrmBnkTMUQTQWKPZWrNeyVXFOjSN5KcAGGnEWGVuiebcB6DxrjJPp9+TJymviOmLoML+B9sYKsEJDDtBOaYQAgN28xUTtIz0QK7dd4DGS/bwFso7GpRurSbnlCobJnRVpQ0ttITGuVE3La/4icyTQeVQJcJjJyoaQpWZBvG0/emYtCPBCQggdkm0LbEk1yOrDRb4zwhMyrl3nz6qB6GtI8kOzekIe01k4AEJFAOgbYl/uzZszF59H3sLTzvusQ7jktLS/mzWTyjxenBZt8C95jh6WMc/ykp3tMfvqOWEpCABEogcJh/NzNbwnq0GYMr3iZtx5LAiRD4Nh+V3/n80rIEJCABCUw1gcNd/FRPo07wbmbr0LOvBCRQMoG2c/ElszA2CUhAAjNGQImfsQV1OhKQgAQOCSjxhywsSUACEpgxAkr8jC2o05GABCRwSECJP2RhSQISkMCMEVDiZ2xBnY4EJCCBQwJK/CELSxKQgARmjIASP2ML6nQkIAEJHBJQ4g9ZWJKABCQwYwSU+BlbUKcjAQlI4JCAEn/IwpIEJCCBGSOgxM/YgjodCUhAAocElPhDFpYkIAEJzBgBJX7GFtTpSEACEjgkoMQfsrAkAQlIYMYIKPEztqBORwISkMAhASX+kIUlCUhAAjNGQImfsQV1OhKQgAQOCSjxhywsSUACEpgxAkr8jC2o05GABCRwSECJP2RhSQISkMCMEVDiZ2xBnY4EJCCBQwLfHhYtjUhgbm5uxB4lmn/69KnEsIxJAhJogoASX4vitOvjbNylai2hnSUw0wRM1Mz08jo5CUig2wSU+G6vv7OXgARmmoASP9PL6+QkIIFuE1Diu73+zl4CEphpAkr8dCzv4uKij0anY6mMUgIlEfCNmpJW44hY5ufn9/f3j2i0WgISkMCRBNzFH4mm2Yb19fWDg4PxfL5582ZhYWG8vvaSgAS6TECJb2n1792719JIDiMBCUjgKwEl/iuJSf5LJn2S7vUtAQlIoD8BJb4/lwZreUy6tbWFw0uXLlHe29ujvLm5STkd+XBk3qnnTOXq6mreFGVyPqkjfqhM3ijUyQj1jmWNBCQw1QSU+G/+/ve/T3QJ+ZKDlZUVhuCRKeWrV68ixEtLSy9fvuQynqOmbT6afufOHeq3t7fR8b6Bra2tcbfAhuPWrVuk+PEWl7u7u2aE+kKzUgLdJOAbNd/84x//uHDhwrHL/9133/31r3+tmH38+PH06dOVyiEvz5w5g+XFixfRax6oRi+U/cGDB1GP+j969KjiLW4PCHqqf/36NR7icmNjI9VbkIAEJDCXi0U3cfzfl+PYuf/222///ve/c7Mffvjhv//976lTp/LKvmX25o8fP0ayEfTcgA14qHNSebbzZHXSZTKO+ocPH759+7ai42R+rl27huWzZ8/Y1KcuwxT4oOAPwDCgtJHAtBKID/iexyDAkg/ZK0/URBfkmO5IOZecoxBN+U9S8p+/NEnfVB8FpD/1olxpHXA5/BQGOLFJAhIoloC5+KSN7RV4Ihq5+JSfyceOnxVEn8pKOp4m6ulbecWe7DxNcdsgF4//3KFlCUigswSU+BNY+idPnqDUPHftHTs9d0X9Q7LjDZxkGXeFuAFEJdl5DspkaeIesLOzk+wtSEACXSagxLex+ufPn2eYDx8+oNfIcXwhQezEuYyXajBg942CJ5WPyOJOEMoeXXgVh6bcjH19fie4ceNG9PUsAQl0nUCkBTyPQYAfneF7xc8ZKXW6JE2nkjR9ZOrDG+VQ8LDHEvsox5mtfZ55xyE1dEnJejyMFNXwxlpKQAJTR8AXKnL9HK08A6+jzMAURlszrSXQMQImajq24E5XAhLoEgElvkur7VwlIIGOEVDiO7bgTlcCEugSASW+S6vtXCUggY4RUOI7tuBOVwIS6BIBv4as1mpX/vdpLV92loAEJNA0AV+abJpoo/58qbFRnDqTQOcImKjp3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpHQInv3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpHQInv3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpHQInv3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpHQInv3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpHQInv3JI7YQlIoDsElPjurLUzlYAEOkdAie/ckjthCUigOwSU+O6stTOVgAQ6R0CJ79ySO2EJSKA7BJT47qy1M5WABDpH4NvOzbgzE56bm+vMXJ3omAQ+ffo0Zk+7TQkBJX5KFmqsMP0FHgtbVzq5CejCSpuo6cIqO0cJSKCjBJT4ji6805aABLpAQInvwip3ZY7r6+skH/b29lqY8OLioomOFjg7RE0C5uJrArR7KQTQ3K2trVKiMQ4JlEHAXXwZ62AUtQk8f/784cOHddysrq4O353hKk+zR+o+/EBaSqAOASW+Dj37zg6Bg4ODx48fjz0fskPb29tjd7ejBCZEQImfEFjdThmBmzdv1on42rVrdbrbVwITIqDETwhsV9xubm7y1DEOnnbm046Hn9FUSWJQSQ073z97zs2xiabv/Px8qsFzeEs1ufPB5RQVDnNLRkneKERTVO7v73MZrRFM3rG3nB63xiwwwEN0T8ZpLIxTJROnniESn4CT00jGFiRQlwD5RI9iCbC6Y8dWp++Qg5L7vnTpUhhHHpxzXC4sLKQAnj17RpkamqLMJR2jhkouOaLjysoK5ZcvX8YlZ6QzjZIq+xYiBtziBIMYK4UUl5yj75cxP+tyXOYB93WeV0bfFDNNRJgHSfypNcoxWWyiL5cRWMyXSw78hHHEn484iXKKcBLO9VkIgfEVpJAJzHYYdX4J6/Qdhmpse3MtZsRcW5OY4g39ojVqomMoWgwU4pu0+Ita/nnnwACfuasBsYXEJz8xUJJLAugdNNVEhAOcV5oq9pWYac1jJgZGD1ZRTq2h6SlmRqnEWRm3wUsGatCbrsokYKKGn3OPcQj8/PPPdLt69WrqzI/4xsYGl7u7u5zPnj2bmpaXlyk/ffo01Vy8eDGVb926RXlnZydqHjx4gDqnRA1PQcMg2Q8uXLlypdeANAiVvYPynuUwaZleh4NrcLu0tJQSNfEg9/3796nX5cuXU9mCBCZHQImfHNsZ9/z27Vtm2FcfeytzuT+WC4LOpvj+/ftYIvSx7T2212CDXF6TZUqbpJpGCjH9/PNN7O9GulE1EolOJKDE+zMwJoHz58/TM/byfV30qmq+ie7tkrfeuXMnNvII/d27d3uNx6vpvffgJx93PLd9e/300099662UQJsElPg2ac/UWJEPuXfvXuRAYm7xckhvWibk/vbt230RhIe8dW1tDUtyHbwS04gExw66kpbhLtLIR4TKpAiYXDzJmaARrXwc4ahYeimBiRMo8xGBUQUBln9sFHX6Djlorz6mx4bxNDJdkhKhJtzGU1DCS6mMvDUNTV9s0mPJVD+g0PdJZhoXVzhkrPAQ/gkmLqMvl5ilwAaMhSuO1D3miz1uqYyHqGGTzuEtLNMQERWjRyt9sU9BDgigfhMD1Xeih8IJuMZFL1CdX8I6fYeHkqt8EvToflRTqBitIXbEmQSuMu5ISpe8hcOQTspxhOdceSvOIyqMjwomxZYsw3OIdfKcIFTMojuD/hnQN99gyVjpkviTk6jEQxp0EgVGmYRbfRZFYI5o0g+ZhdIIXLhwIZ5qjhdYmYtLQhylQ93i9Zujphb/kSoyNkfZWF+HAC/8lPkTUmdS9q0Q8JsmK0DKuvz111/HDohf4LH7ltCRLH9lI1xCVMYggeki4OPW6VqvWYj2w4cPTKPvyy35f+Inj9HIg9ZZQOYcJDAuASV+XHL2G4sAb5XEN3bxckvv54wzZ86EV/S9kqLhlpD+J1HfQoPvq/T1nyorX8UzFgY7SaAlAibjWgLd/jBIkpnW9rFP0Yj+hEzRYo0dqrv4sdHZUQISkEDpBJT40lfI+CQgAQmMTUCJHxudHSUgAQmUTkCJL32FjE8CEpDA2ASU+LHR2VECEpBA6QSU+NJXaDbi4wu5mnqpMf1Fvekiwyv/+beSTVfwRju9BJT46V27qYmcl/P45uFGvi2dL57khfqpmXkWKH87BQigyOosSmDiBJT4iSPu+ACIMt8Ilv8/pjqb2Tdv3uRfNzZdbIEAClV+ulZt2qP1f8dM+woeGX8J/7El1Dz/urH4DrI6/yeLRA0b+ToejkTWSkMvk1aG7TNICT8hfcKyqlECfg1Zozh1lhFAzfmzGJUvyL1582Zm0sUif8SKL9rk75/kf/a2iyCccysETNS0grmTg/A3/9CyJGTxJTPx5ZHsHzmoAQxf+RKXnMnq5Kiinm07ln2/GSbvO8zjXBzijSEYKJznvShHZZxTJFHPOX1LWooz2ccfrkpd2KqnpphmauK71cDin/1LQCxMlgAfeD1mkgA/Nyc7L4SMvHklhsikp0q+bow4429fxH4//UUOLMlcYxn1WEavigdGSd4GFNKHCezTiFGOXoxFPWZcxn0ogk9/tYPLqAlLyokwhTwMyhE5rvLhUnj0ze1TfcuFFH/L4zpcmwTcxfNz7jERAgjlkN8GHGax3097XhLuZ8+eJTLqk0DngcbmmgeweeVRZZzwexWtFGLEyBqlEWmNr7qMjXZ45kFCaDqVz58/xya9GpQcItlxV6CVqNjjJ5unT59S+ejRI87pwBX2+bipyYIEmiWgxDfLU29/EhhSv3jJJIQyciA5Pva5fO1w5FUQ6PydHMxI0ezu7iaRzTsOLqccS8UMUQ7pJ3JyLEmyk9n169dTeUCBqOJ7kiNRE9+cXKHB25MDPNgkgQYJKPENwtTVOAQin/7gwYOKXm9vb+Mu5LJXl/mbUDzLZcs8zpBH9ImPBWztiSQSLEcYDqpGzVOuCT9xxPZ/UDfbJDAZAkr8ZLh23mtkQo7FwGPJ+AN+vSKIh9BHnLCnrqg8Tajw0tJSZYN87IhHGXCnwRsZoSEzP0f5oZ57z4BWmyTQJgElvk3a3RoLCT5Wf1FDEtl97weRogEZas6z1t7kdWjx2NvtymI8efIEV/E8oNI00uXy8jL2ZGnyXmkuUcmfXGesvrPOe1mWQH0CSnx9hnroT+DOnTukWSptoWtIP1kR8u8oXbJhHx3G0Up9/C+hqEyaGMoeN494DFsR0MqI6TK65Jv0qIm/JcunhHQXIbaUiyeqd+/e4STOFHr95CGR0ydUzNJLkxRC91Mk5KD8/wGJhoXJEojPwp5njwA/Nyc7qVDJeA0xRZKkMxLW+asybNXjTUQkEnsM4lWW+AUID/kvA63xzmVU0jeN0lvIB8KeMEKIo298SkjOGZojLlOBS4bIQ6KGgVIvCrTG0DGRaEqV0dQXS2/ALdRE/C0M5BAnSMAvMMh/Q2eqzOaRH6yTnRLbcPa8vXn2k43qZEePjyb5lzqcVDwl/ISc1Ny7M+7Jq0B3WLc800J+gUmAkLGpvPLYMopyhiM3xWuUJ37rDSCF/ISUszozGYnfUTOTy1rQpMhTIyUEpMqT4uelnUL0vaAfEUOZJAEft06Srr6/EEDUeIcEgZsoDxIg3EuOOirvXE40kr7O2b/zP13V975wrJwcARM1k2N7wp4RuxOOwOGLJ+Atp/glqhugEl+XoP2nhQD3PBVtWhbLOJsiYKKmKZL6kYAEJFAcASW+uCUxIAlIQAJNEVDimyKpHwlIQALFEVDii1sSA5KABCTQFAElvimS+pGABCRQHAElvrglMSAJSEACTRFQ4psiqR8JSEACxRFQ4otbEgOSgAQk0BQBJb4pkvqRgAQkUBwBJb64JTEgCUhAAk0RUOKbIqkfCUhAAsURUOKLWxIDkoAEJNAUASW+KZL6kYAEJFAcASW+uCUxIAlIQAJNEVDimyKpHwlIQALFEVDii1sSA5KABCTQFAElvimS+pGABCRQHAElvrglMSAJSEACTRFQ4psiqR8JSEACxRFQ4otbEgOSgAQk0BQBJb4pkvqRgAQkUBwBJb64JTEgCUhAAk0RUOKbIqkfCUhAAsURUOKLWxIDkoAEJNAUASW+KZL6kYAEJFAcgW+Li8iAJDCFBObm5qYw6ukI+dOnT9MRaJFRKvFFLotBTSEBlWgSi+a9syZVEzU1AdpdAhKQQLkElPhy18bIJCABCdQkoMTXBGh3CUhAAuUSUOLLXRsjk4AEJFCTgBJfE6DdJTACgfX1dZ4f7u3tjdBnyk2ZLFNm4lM+j2kNX4mf1pUz7qkjsLi4eO/evQmFvbm5iZKmIyR1dXV1QsPpdloIKPHTslLGOfUEnj9//vDhw/rT6BVulH1paenly5e8uBnH27dvqXz8+HH94Wp6uHr1KiGtra0lP+zruSGlSwsTJaDETxSvziXQMIHejAdSzhj7+/uIaRpsY2OjkdtJcthg4cGDBw1609VgAkr8YD62SqAgAux/K6me2NGj5hcvXqwEysb50qVLBwcHlfqTveQWtbW1dbIxdGp0Jb5Ty+1kiyMwPz9fSaBHiCm3TgFZRKk5X7t2jVbSL3Qhsx9lzj/++GP0qpzv3LmT16SBKOTSz30iahgibOLOEU9Koyb5SY9P8RBNnKM1zSXPwyR7bNLTCNJK9GK45NbCpAh8zd35rwRmnAC/QpOb4ZDOI3mSkubsshcWFiKqlZUVnEQTWZfkMOqpwSzqqYkuGGOWLAfMLiwZPWwYl14xVpS5JJIwiBG55MA++sagEX8Y0zG1YkllBBkOY6Bkn4Z+9uwZlpzD4NgzxsfaaDCAgN9Rw4+QR1cIpP1mPuHTp0+fOnUqrxlQxhL7AQajNqUEy/Xr19mev3//Hg+vX79OyktW/SifYZwsjzKjfnl5GbP0zPPp06d8IKDyzZeDPTtDc3nr1i2Mb9++zeWNGzfCPlL8seun5sqVK/Fhgq4Y04pnyqhMBHDz5k26Y8/Ucvto9dwyASW+ZeAOd5IEkgzlQXz8+PH333/PawaUscS+1+DFixe9lcfWhEpiFiKb7M+ePcuOmBsSu11kd4DKpy4DCqgt3mKjHWahy1SSRUkPaS9fvjzASaWJG0ClxssyCSjxZa6LUbVHYNRd+ffff99gcOSvkVqknF08GerwjOyS2eDJKjUclNMGPB86RJnusWXOm/Lyhw8f8ssox7i99dbMGAEft87YgjqdaSLAPh2p5bNFZEjy0NF06iNzjdb3fTJJJiT25iR28r59y+kTQ9565syZ/NLy7BFQ4mdvTZ3RdBCI107IgPeGS1O0Iv0IPcnunZ2dXjNqIofDTr9vKzcGjjwtk8xQfG4P6UlAqrcwYwSU+BlbUKdTNIFQ6nhMSsKdWHd3dyPi+/fvRwFRpoBqkyiPGs6R+w5Fjief8V4jNfHGCx8I4q6QuvD5gHJkeHi+Sjkek1LAkvROGjEcpnxOhMf/j8WSI1rTh4BKKwa44vhie2ifvL169Yra5C1m/e7dOypjCqmjhYkQYI/gIYEuEOD3Z3LTHMZ5/upLvEQYryfGL3YoNWWayM9wmR6QprckiZ/WZJ9PJ3cVBshubpCrMAapqRJV7ocAUlThM2+lY6WVIQZ7i0HTvFIMAwp5qAPMbDqKwBwNsXieJTDbBNjnTu6nfaLOZ3tdBs9OsIP5HNtqouZYRBpIQAISmFYCSvy0rpxxS0ACEjiWgBJ/LCINJCABCUwrASV+WlfOuCUgAQkcS0CJPxaRBhKQgASmlYBfYDCtK2fcpRHg3Y/SQjIeCSjx/gxIoAECk3sds4HgdNFhAiZqOrz4Tl0CEph1Akr8rK+w85OABDpMQInv8OI7dQlIYNYJKPGzvsLOTwIS6DABJb7Di+/UJSCBWSegxM/6Cjs/CUigwwSU+A4vvlOXgARmnYASP+sr7PwkIIEOE1DiO7z4Tl0CEph1Akr8rK+w85OABDpMQInv8OI7dQlIYNYJKPGzvsLOTwIS6DABJb7Di+/UJSCBWSfgN03O+go7v1YI+E3Ck8Pst3jWYavE16FnXwkcElCJDlk0V/LeWZOliZqaAO0uAQlIoFwCSny5a2NkEpCABGoSUOJrArS7BCQggXIJKPHlro2RSUACEqhJQImvCdDuEpCABMoloMSXuzZG1jUCq6urvEBycHDQtYk738kRUOInx1bPEpCABE6YwJwv857wCjh8WwTYIE/up32izkclxKeBjY2NUXuVaV8U2DIRDY7KXfxgPrZKYMoIrK+vT1nEhjtJAkr8JOnqWwLtEtjb27t37167Yzpa0QSU+KKXx+A6RaDyuHVxcZE0BQSinjKFBGRzc5MaDgrs3HlIy/natWsYPH78mHq6h/H8/PwXw8+nfI9PPQc2MVCllfo0Lk3cPMJbxWd4SE2fx/gydMST6i2cGAGykx4S6AKBo37HTp8+fX7o4/vvv/97vwPnNRleunQpItzf38dVipb6Z8+eUbOyskLly5cvKWOTRoz66BX11KRg6L6wsBCXyUOY4SEGDZ+YURN+sOcy+YmmfOh8OJyEf8wiVCxx9fDhwxTG2IU0zbE9dLyjX0PGj5BHVwjw29471Y8fP/7++++99X1rsMS+t+nFixe9lSPVvHnzhl0zG/DoRahsrre2tra3ty9evEjl9evXaX3//j3l169fhzpTPvbJanTPPVy9ehX/bMBDqWniuHHjBsN9+PABez4ZUE647t+/z2UM/ejRI7Q7fHKmTGoI+1u3bmGDJa7wj8q/erdCiqwAABQISURBVPXqi2NPJ0lAiT9J+o5dAgF28SOFwUZ+JPuaxkmgcz9nz55FnUmJsGtGWweoPHeO6JjfP5KrdJ9INVF4+vRp7NzjMm4JUeaWw9CVjP+7d+9oxRuZIjo+f/6cLhzRxfMJEjAXf4LwHVoCYxJAPdk+03lpaQmhzzPsvR7ZrWPDhwDuB72tfWu4MaR7Q8UAfY9sDHv8dKytrWGG+nNmL89wlRx9xYmXrRFQ4ltD7UASaJIAqorChmqzpz5K5UNtsWSzP/zwkcOpPGJN3dnjp3Je4ANHiD6V3AlU+RzOSZWV+JMi77gSGJ8AuW8O+iPcqCoZkp2dnV53YbO8vNzbNLiGvDwG8X5Osoz3eXgGyz49va5DK3eCuMGkSkLiQwYq75cxJHonVVDiT4q840qgSiASHTzwjIZIlSSVjHx3nDEgRZPvskOUI3EfXVBkUvZY7u7uhsN4Fko5FBkJ5ogmzm/fvuUcz1T5iBBpej4EpOP27dsY3L17l3NkY6KJO8GPP/4YlXEboMyBh74PEqLVc0sE4oOVZwnMPAF+oyY3x/rO81/4StKcy3jfMWzi3UReWUlPRNPbjUwwcvRYxjuOecd4l5GmvDIsk6toDVCh8tRwhLcEMCrjzH0i6nGbR56M6xQYok53+07wWzvyHwLLEjhxAmw5+YWfUBgTdT6hmKfCrWBrLpOJmpoA7S4BCUigXAJKfLlrY2QSkIAEahJQ4msCtLsEJCCBcgko8eWujZFJQAISqEnALzCoCdDuEviTAA8GZSGB0ggo8aWtiPFMJYHJvavTOI4LFy788ssvfLdm4551WCABEzUFLoohSUACEmiGgBLfDEe9SEACEiiQgBJf4KIYkgQkIIFmCCjxzXDUiwQkIIECCSjxBS6KIUlAAhJohoAS3wxHvUhAAhIokIASX+CiGJIEJCCBZggo8c1w1IsEJCCBAgko8QUuiiFJQAISaIaAEt8MR71IQAISKJCAEl/gohiSBCQggWYIKPHNcNSLBCQggQIJKPEFLoohSUACEmiGgBLfDEe9SEACEiiQgBJf4KIYkgQkIIFmCCjxzXDUiwQkIIECCSjxBS6KIUlAAhJohoAS3wxHvUhAAhIokIASX+CiGJIEJCCBZggo8c1w1IsEJCCBAgko8QUuiiFJQAISaIaAEt8MR71IQAISKJCAEl/gohiSBCQggWYIKPHNcNSLBCQggQIJKPEFLoohSUACEmiGwLfNuNGLBCQggW++mZubE8OJE/j06VOKQYlPKCxIQAINEMj1pQF3uhiRQOUua6JmRH6aS0ACEpgeAkr89KyVkUpAAhIYkYASPyIwzSUgAQlMDwElfnrWykglIAEJjEhAiR8RmOYSkEANAqurqzwPjGN+fr6Gp2ntyqy/ApiDxqSnocRPmrD+JSCBKoH9/X1evHnz5s36+nrSuyiE6d7eXqWemqqX6bxm1swdAkOGH4g4D2lfMVPiK0C8lIAE2iOwtraG3q2srDBk6H6MffXqVeqfPXvGJWfK1Iwd1ubm5pTeIbjP3bt3b+yJ01GJr0PPvhKQwBQQuH///hRE2S9E7m0vX77s1zJsnRI/LCntJCCBaSRAvnv4rMg0TnBwzEr8YD62SkACZRHI0/eVx5XpWe7BwUE08Wzz8ePHTODatWskPcjYUKawuLhIIT35jPqYJ+X8MUBUco56zuk5QXpcnOwr6aAUDwaElFy1WVDi26TtWBKQQC0CSDO5adIXHOToke8Qa5wivshoNN28eXN7e5tKnm0+fPiQAukOms6ePYvaRj0FbKi8dOnS0tISlRw4oRzGsfcP/4h12Dx9+vTBgwcxOga04icGpfvy8vJnL18ObgDXr1+PJobgOBGV9ztqvi6I/0qgGwT+85//sKX99tsxf/dPnz596tSpSaBCBAe7RX+3trbiGSyWt27dQnCpoZ7y7u7uxYsXwwPKnqQ/9xlPcUPlEd9o4n7ArQL9Td3PnDlDE5eEhCvKGxsb6DUqTyVlahgxRD/5WVhYIJjwSUhIPDZxSZwwf/ToUfSNynbOYy5zO8E5igQk0DiB77777l//+hf72fE8v3///o8//jiq74sXL45qOraeTXES2TCOPXXqiIhTziNn14yqIqCI6fnz59ngI9bh5/nz56ljbyHlWCpN+OGgEsWPW07lxoPQV7r0vSRUAot7STI4ahdfmSa3isHBJ4fDFJT4YShpI4HZIfCXv/wFlUQQx5vS2B3HGy7v1SuRudzz/uXOzg7CGqJMsmW89yxDcHHC9vyoO0EeVd8yofImaPt79t5gzMX3MrFGAhIolwAfIyrBpb0/m190Od6yJzFSefhZ6dX3kme5pF+4PUR+pq/NkJV8nhjSks8NhJ2OBrfwBKDED7kKmklAAidMIB5mkpZJcYTc3759mxqeiMY2n71zPCl99epVshyy8OTJE/bv423/8yEi1Eqipu/jgbzXJMpK/CSo6lMCEmieALvdeKSZ/jc//6eJmqTIlbz5lStXCOLcuXOcuRlwA6Bj3AbyTXrUfPjwATMyM9weooaMTdwqqKfju3fvKMSZQq+f8Bn1hBrBoPLpyN+3wUNLR/p0YEECs02A36jZnuCQsyOZ/uuvvw5pPKrZsZDz7yrAebzRmItdjEiqJK+kHC8y0hoeopXuKULqKade8bUH0Rpqy7niFgXP7wp4S5qOHxxyhMNU4JKbSnqrJ1rzcalJQ2MZBnllhBQD4TYujzrn4eEkQTjKnnrM8tbPb3SmICxIYIYJsJnyp531vXDhwi+//DKhp6bHQiadkl56meEftmOnxmYf+UbiG38kW1kCEzXHroUGEpCABKaVgBI/rStn3BKQgASOJaDEH4tIAwlIoGEC5CjIJ4z91nnD0bTrjlkz90qSfXIhmJ2cHFs9l0WgkqMsK7gWoznZXHyLE+3oUJWfc3fxHf05cNoSkEAXCPgFBl1YZecogfYIsItsbzBHOo6AEn8cIdslIIGhCfha6tCoWjI0UdMSaIeRgAQk0D4BJb595o4oAQlIoCUCSnxLoB1GAhKQQPsElPj2mTuiBE6SwG+//cZfBTnJCBy7RQK+F98ibIc6UQKV94VPNJaTHFwOJ0m/9bHdxbeO3AElIAEJtEVAiW+LtONIQAISaJ2AEt86cgeUgAQk0BYBJb4t0o4jAQlIoHUCSnzryB1QAhKQQFsElPi2SDuOBCQggdYJKPGtI3dACUhAAm0RUOLbIu04EpCABFonoMS3jtwBJSABCbRFQIlvi7TjSEACEmidgBLfOnIHlIAEJNAWASW+LdKOIwEJSKB1Akp868gdUAISkEBbBPzDfm2RdhwJdICAf7i1hEXO/7yiEl/CihiDBGaHQK4vszOr6ZlJ5S5romZ6ls5IJSABCYxIQIkfEZjmEpCABKaHgBI/PWtlpBKQgARGJKDEjwhMcwlIQALTQ0CJn561MlIJTD+BxcVFngfGQXn6JzTaDA4ODr7O/vO/m5ubo/Uf3VqJH52ZPSQggXoEeOuG4/nz57niI3lJ9NfX13MppFxvwFJ6X7x4Meb+7NmzYWLKIQxj32ujxPcysUYCEmiJACqP5F36coTox8Bra2tcrqyscLm/v0+5TkDcMNg+1/FwIn0rNzYux5iFEn8ia+egEpBAewTu3bvX3mANjcRtiTsc97Y4FhYWcPzo0aNR3SvxoxLTXgISmCYCKfkzTUF/iXVjYyPFzMedVB6poMSPhEtjCUjghAmsrq6mDDVb3TyalNmnEjPOWG5tbVEgFUR5b28vHnim1nBFffKTPwaYn5+v1GPJM9LoFTeP/AlqJZGS4sE++RmyQKqq1/L69eu9lYNrlPjBfGyVgAQKIoDmbm9vR+7i4cOHZGBCrAkRaU4PM5HUUFss84T++/fv0XqMcYJN+OFyeXmZMwdO8BnZ/5cvX1II/4h1ZHsePHiwu7tLR0bn5kH9zZs3ucSS7ikYyvi/f/9+GmIMlf8c0Ncj3r25devW14ph/1XihyWlnQQkMDkCSCQiWDkeP36cj4j+Yvb06dOoZJ+LXmMTe/CdnZ3z589HE8IahcoZiQwt5laRbEhzR2Uy5lZB+erVq5zjVkGeBE3n8saNG5E/+fHHH7nE8s2bN1EgmChzSajcWsIDl/H+DJWUxzuY9ZAv4VT8K/EVIF5KYMYJpB1rUfNEH2PDm59jA57iRMQpnzlzJtXcuXOH8k8//cQZtWWjzU0iWgcnr0PEk59UiDd5uOS2kVylVgpXrlzJL48qEyr3nnTHWlpawvLt27d97ZH+ZEkh/ygQ9mzhCXiMLTzd/abJvsytlMDMEvjb3/7WV7xOnz596tSpIaeNJfZDGjdllvbIyeG5c+dSmc016Zf4NEAlhaN0PHXpW0BwuVWwtedm0xdU316VSkJl1983n16xPPaSmw1b+MF3rAFOlPgBcGySwAwS+H9fjt6Jffz48ffff++t71uDJfa9TS9evOitbLbmw4cPFe1O+Zm4B5AfJ0vOx4IxVJ4dNLvvMTr2zvHJkydDSjxmR1mSJuJTV++9rXe4o2qU+KPIWC+BbhEYdVf+/ffftwyItAz7a9IyKcf97t07Yoi0OMoeW13O7HyvXbv2+vXrys3g2IDRd/bvo/bqdRuhkvFP6oxY81Z7/h5kb6/eGp7lJg+0jvHQVYnvpWqNBCRQIgG2umyNUWHeHYzENIpPvj4pci6pTODy5cucY4/P3p+DN2rOnj1LZTxEjUmGhlKDH/b+8ZIlTenpKE3cLSKTjofohbeKH/b+0cSZUImNmjzVwys6yeDYAoMSDGa5By7TU+JjPfxpkD/csCyBGSYQvx4zPMESpnYsZPbIuU1c/ilG33wTGXAmEq+vpPqjuvCSSZo1Wp+LLHqamsIPzisvpWCQD0FrrsLEEOEhtXmcDJSHFxmh3E8aOjQ6mlJlRBWRcE5B5oV8IrnnxCc3rpSxz2s+vxmau7AsgVklwG7In/ZJL+6xkCNR7kKQcuE1GyR+vPdkBqxjZQl8aXIAK5skIAEJTDcBJX6618/oJSABCQwgoMQPgGOTBCQwEQIkEzhI2kzEe8FOeYgac4//DNVCpGYnW4DsEEUQ4FfLFPCkV0LIkyZ8rP/KEriLP5aYBhKQgASmlYDvxU/ryhm3BMokwC6yzMC6GZUS3811d9YSmAgBU2ETwVrDqYmaGvDsKgEJSKBsAkp82etjdBKQgARqEFDia8CzqwQkIIGyCSjxZa+P0UlAAhKoQUCJrwHPrhKQgATKJqDEl70+RicBCUigBgElvgY8u0pAAhIom4ASX/b6GJ0EJCCBGgSU+Brw7CoBCUigbAJKfNnrY3QSkIAEahBQ4mvAs6sEJCCBsgko8WWvj9FJQAISqEFAia8Bz64SkIAEyiagxJe9PkYnAQlIoAYBJb4GPLtKQAISKJuAEl/2+hidBCQggRoElPga8OwqAQlIoGwCSnzZ62N0EpCABGoQUOJrwLOrBCQggbIJ+Ldby14fo5sSAv5N6sktlH8Ptg5bJb4OPftK4JCASnTIormS986aLE3U1ARodwlIQALlElDiy10bI5OABCRQk4ASXxOg3SUgAQmUS0CJL3dtjEwCEpBATQJKfE2AdpeABCRQLgElvty1MTIJSEACNQko8TUB2l0CBRFYXV0dMprhLYd0qFmZBJT4MtfFqCQwMoHNzc2Dg4NhumH2+PHjYSy1mXYCSvy0r6DxS+AzAVR7aWlpSBY3b94c0lKzaSegxE/7Chp/5wig5vyfTw6SLXt7e2zeOS5dugSIra0t6ufn5wPK4uLiF8M/jamMvvv7+5SjCSdRWF9fTwbUJCdUUk41ZngAMkWHEj9Fi2WoEvhMgD34y5cv+b6E69evX7t2jZpbt27F1ycsLCxQePPmDZXoOwUuOR4+fEhmhjvBxYsXucQMgy8tnzY2Np49e8ZlHGHw9erzv2j6nTt3MN7e3kbo8ybL5RNQ4stfIyOUwCEBtuHswc+cOUMVyp6r86HR11LaiV+5coW6d+/efW35n3/Pnj37P9fffBOfCaISZT937hxl1D+2/xVjL0smoMSXvDrGJoEqAXSWKiQ4EiaoPEfV6Mv18y8HRTIwsdnva3ZsJfcJsvxxt2B0dv3HdtGgHAJKfDlrYSQSGIoAWRrsSLyQNiEbM6BP5OIxiC4DLAc0caeglf07w3EMsLSpQAJKfIGLYkgSGETg6tWrZMYjZ8Lz1aNUnn135OLX1tYGuRuiLbL2kb1R5YcAVpCJEl/QYhiKBI4lQC4+UjTxXHRlZQWV7+3FmzbcA3hM2tvUWxOZ/d76qEm3EG4YkfrH+VHG1pdGwD8JUtqKGM+kCPzzn/+8cOHC2N5Pnz596tSpsbs32JEUzfnz59PePF6PwT+77HiXhnvA3bt3qdnZ2QmzBw8eRAC8VHP58uVI6HO3eP36Nc9a+VhA65MnT8IYTY+PCGzYKeCTmkjXhJOwj7LnwgnM8RGs8BANTwKNEPi/L8fYrt6/f//HH38c1f2HH35o51cJXf75558J4969e5yTrFNGvuN/P7HX5hksT1nDhiZy8fHElV0/z0txElmXuMz7hvHy8jKFdMO4fft2emCL6McdAoMWDm4z7YBtYS4nMoT4TgS7g84aAZVoQisq2JpgzcXXBGh3CUhAAuUSUOLLXRsjk4AEJFCTgBJfE6DdJSABCZRLQIkvd22MTAISkEBNAkp8TYB2l4AEJFAuAd+LL3dtjGy6CPDux3QFbLRdIOBLk11YZecoAQl0lICJmo4uvNOWgAS6QECJ78IqO0cJSKCjBJT4ji6805aABLpAQInvwio7RwlIoKMElPiOLrzTloAEukBAie/CKjtHCUigowT+P3lVBRYP2wERAAAAAElFTkSuQmCC" alt="img">　　① <strong>任务创建</strong>，Core进程启动时，首先向/mysql_replicator/tasks节点注册任务，如创建一个子节点/mysql_replicator/tasks/copy_hot/item，若注册过程中发现该子节点已经存在，说明已经有其他Task机器注册了该任务，因此其自身不需要再创建该节点。</p><p>　　② <strong>任务热备份</strong>，为了应对任务故障或者复制任务所在主机故障，复制组件采用”热备份”的容灾方式，即将同一个复制任务部署在不同的主机上，主备任务机通过Zookeeper互相检测运行监控状况。无论在第一步是否创建了任务节点，每台机器都需要在/mysql_replicator/tasks/copy_hot_item/instrances节点上将自己的主机名注册上去，节点类型为临时顺序节点，在完成子节点创建后，每天任务机器都可以获取到自己创建的节点名及所有子节点列表，然后通过对比判断自己是否是所有子节点中序号最小的，若是，则将自己运行状态设置为RUNNING，其他机器设置为STANDBY，这种策略称为小序号优先策略。</p><p>　　③ <strong>热备切换</strong>，完成运行状态的标示后，其中标记为RUNNING的客户端机器进行正常的数据复制，而标记为STANDBY的机器则进入待命状态，一旦RUNNING机器出现故障，那么所有标记为STANDBY的机器再次按照小序号优先策略来选出RUNNIG机器运行（STANDY机器需要在/mysql_replicator/tasks/copy_hot_item/instances节点上注册一个子节点列表变更监听，RUNNING机器宕机与Zookeeper断开连接后，对应的节点也会消失，于是所有客户端收到通知，进行新一轮选举）。</p><p>　　④ <strong>记录执行状态</strong>，RUNNING机器需要将运行时的上下文状态保留给STANDBY机器。</p><p>　　⑤ <strong>控制台协调</strong>，Server的主要工作就是进行任务控制，通过Zookeeper来对不同任务进行控制和协调，Server会将每个复制任务对应生产者的元数据及消费者的相关信息以配置的形式写入任务节点/mysql_replicator/tasks/copy_hot_item中去，以便该任务的所有任务机器都能够共享复制任务的配置。</p><p>　　在上述热备份方案中，针对一个任务，都会至少分配两台任务机器来进行热备份（RUNNING和STANDBY、即主备机器），若需要MySQL实例需要进行数据复制，那么需要消耗太多机器。此时，需要使用冷备份方案，其对所有任务进行分组。</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　Core进程被配置了所属组（Group），即若一个Core进程被标记了group1，那么在Core进程启动后，会到对应的Zookeeper group1节点下面获取所有的Task列表，假如找到任务”copy_hot_item”之后，就会遍历这个Task列表的instances节点，但凡还没有子节点，则创建一个临时的顺序节点如/mysql_replicator/task-groups/group1/copy_hot_item/instances/[Hostname]-1，当然，在这个过程中，其他Core进程也会在这个instances节点下创建类似的子节点，按照”小序号优先”策略确定RUNNING，不同的是，其他Core进程会自动删除自己创建的子节点，然后遍历下一个Task节点，这样的过程称为冷备份扫描，这样，所有的Core进程在扫描周期内不断地对相应的Group下来的Task进行冷备份。</p><p>　　在绝大多数分布式系统中，系统机器间的通信无外乎<strong>心跳检测</strong>、<strong>工作进度汇报</strong>和<strong>系统调度</strong>。</p><p>　　① <strong>心跳检测</strong>，不同机器间需要检测到彼此是否在正常运行，可以使用Zookeeper实现机器间的心跳检测，基于其临时节点特性（临时节点的生存周期是客户端会话，客户端若当即后，其临时节点自然不再存在），可以让不同机器都在Zookeeper的一个指定节点下创建临时子节点，不同的机器之间可以根据这个临时子节点来判断对应的客户端机器是否存活。通过Zookeeper可以大大减少系统耦合。</p><p>　　② <strong>工作进度汇报</strong>，通常任务被分发到不同机器后，需要实时地将自己的任务执行进度汇报给分发系统，可以在Zookeeper上选择一个节点，每个任务客户端都在这个节点下面创建临时子节点，这样不仅可以判断机器是否存活，同时各个机器可以将自己的任务执行进度写到该临时节点中去，以便中心系统能够实时获取任务的执行进度。</p><p>　　③ <strong>系统调度</strong>，Zookeeper能够实现如下系统调度模式：分布式系统由控制台和一些客户端系统两部分构成，控制台的职责就是需要将一些指令信息发送给所有的客户端，以控制他们进行相应的业务逻辑，后台管理人员在控制台上做一些操作，实际上就是修改Zookeeper上某些节点的数据，Zookeeper可以把数据变更以时间通知的形式发送给订阅客户端。</p><h4 id="5-集群管理"><a href="#5-集群管理" class="headerlink" title="5. 集群管理"></a>5. 集群管理</h4><p>​    Zookeeper的两大特性：</p><p>　　<strong>· 客户端如果对Zookeeper的数据节点注册Watcher监听，那么当该数据及诶单内容或是其子节点列表发生变更时，Zookeeper服务器就会向订阅的客户端发送变更通知。</strong></p><p>　　<strong>· 对在Zookeeper上创建的临时节点，一旦客户端与服务器之间的会话失效，那么临时节点也会被自动删除。</strong></p><p>　　利用其两大特性，可以实现集群机器存活监控系统，若监控系统在/clusterServers节点上注册一个Watcher监听，那么但凡进行动态添加机器的操作，就会在/clusterServers节点下创建一个临时节点：/clusterServers/[Hostname]，这样，监控系统就能够实时监测机器的变动情况。下面通过分布式日志收集系统的典型应用来学习Zookeeper如何实现集群管理。</p><p>　　分布式日志收集系统的核心工作就是收集分布在不同机器上的系统日志，在典型的日志系统架构设计中，整个日志系统会把所有需要收集的日志机器分为多个组别，每个组别对应一个收集器，这个收集器其实就是一个后台机器，用于收集日志，对于大规模的分布式日志收集系统场景，通常需要解决两个问题：</p><p>　　<strong>· 变化的日志源机器</strong></p><p>　　<strong>· 变化的收集器机器</strong></p><p>　　无论是日志源机器还是收集器机器的变更，最终都可以归结为如何快速、合理、动态地为每个收集器分配对应的日志源机器。使用Zookeeper的场景步骤如下</p><p>　　① <strong>注册收集器机器</strong>，在Zookeeper上创建一个节点作为收集器的根节点，例如/logs/collector的收集器节点，每个收集器机器启动时都会在收集器节点下创建自己的节点，如/logs/collector/[Hostname]</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　② <strong>任务分发</strong>，所有收集器机器都创建完对应节点后，系统根据收集器节点下子节点的个数，将所有日志源机器分成对应的若干组，然后将分组后的机器列表分别写到这些收集器机器创建的子节点，如/logs/collector/host1上去。这样，收集器机器就能够根据自己对应的收集器节点上获取日志源机器列表，进而开始进行日志收集工作。</p><p>　　③ <strong>状态汇报</strong>，完成任务分发后，机器随时会宕机，所以需要有一个收集器的状态汇报机制，每个收集器机器上创建完节点后，还需要再对应子节点上创建一个状态子节点，如/logs/collector/host/status，每个收集器机器都需要定期向该结点写入自己的状态信息，这可看做是心跳检测机制，通常收集器机器都会写入日志收集状态信息，日志系统通过判断状态子节点最后的更新时间来确定收集器机器是否存活。</p><p>　　④ <strong>动态分配</strong>，若收集器机器宕机，则需要动态进行收集任务的分配，收集系统运行过程中关注/logs/collector节点下所有子节点的变更，一旦有机器停止汇报或有新机器加入，就开始进行任务的重新分配，此时通常由两种做法：</p><p>　　<strong>· 全局动态分配</strong>，当收集器机器宕机或有新的机器加入，系统根据新的收集器机器列表，立即对所有的日志源机器重新进行一次分组，然后将其分配给剩下的收集器机器。</p><p>　　<strong>· 局部动态分配</strong>，每个收集器机器在汇报自己日志收集状态的同时，也会把自己的负载汇报上去，如果一个机器宕机了，那么日志系统就会把之前分配给这个机器的任务重新分配到那些负载较低的机器，同样，如果有新机器加入，会从那些负载高的机器上转移一部分任务给新机器。</p><p>　　上述步骤已经完整的说明了整个日志收集系统的工作流程，其中有两点注意事项。</p><p>　　①<strong>节点类型</strong>，在/logs/collector节点下创建临时节点可以很好的判断机器是否存活，但是，若机器挂了，其节点会被删除，记录在节点上的日志源机器列表也被清除，所以需要选择持久节点来标识每一台机器，同时在节点下分别创建/logs/collector/[Hostname]/status节点来表征每一个收集器机器的状态，这样，既能实现对所有机器的监控，同时机器挂掉后，依然能够将分配任务还原。</p><p>　　② <strong>日志系统节点监听</strong>，若采用Watcher机制，那么通知的消息量的网络开销非常大，需要采用日志系统主动轮询收集器节点的策略，这样可以节省网络流量，但是存在一定的延时。</p><h4 id="6-Master选举"><a href="#6-Master选举" class="headerlink" title="6. Master选举"></a>6. Master选举</h4><p>​    　在分布式系统中，Master往往用来协调集群中其他系统单元，具有对分布式系统状态变更的决定权，如在读写分离的应用场景中，客户端的写请求往往是由Master来处理，或者其常常处理一些复杂的逻辑并将处理结果同步给其他系统单元。利用Zookeeper的强一致性，能够很好地保证在分布式高并发情况下节点的创建一定能够保证全局唯一性，即Zookeeper将会保证客户端无法重复创建一个已经存在的数据节点。</p><p>　　首先创建/master_election/2016-11-12节点，客户端集群每天会定时往该节点下创建临时节点，如/master_election/2016-11-12/binding，这个过程中，只有一个客户端能够成功创建，此时其变成master，其他节点都会在节点/master_election/2016-11-12上注册一个子节点变更的Watcher，用于监控当前的Master机器是否存活，一旦发现当前Master挂了，其余客户端将会重新进行Master选举。</p><p>​    <img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gmm0j4xv9ej306w047q2r.jpg" alt="FA746230-F0C3-4CC3-A07A-8EE29B60568C"></p><h4 id="7-分布式锁"><a href="#7-分布式锁" class="headerlink" title="7. 分布式锁"></a>7. 分布式锁</h4><p>​    分布式锁用于控制分布式系统之间同步访问共享资源的一种方式，可以保证不同系统访问一个或一组资源时的一致性，主要分为排它锁和共享锁。</p><p>　　<strong>排它锁又称为写锁或独占锁</strong>，若事务T1对数据对象O1加上了排它锁，那么在整个加锁期间，只允许事务T1对O1进行读取和更新操作，其他任何事务都不能再对这个数据对象进行任何类型的操作，直到T1释放了排它锁。</p><p><img src="data:image/png;base64,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" alt="img">　　① <strong>获取锁</strong>，在需要获取排它锁时，所有客户端通过调用接口，在/exclusive_lock节点下创建临时子节点/exclusive_lock/lock。Zookeeper可以保证只有一个客户端能够创建成功，没有成功的客户端需要注册/exclusive_lock节点监听。</p><p>　　② <strong>释放锁</strong>，当获取锁的客户端宕机或者正常完成业务逻辑都会导致临时节点的删除，此时，所有在/exclusive_lock节点上注册监听的客户端都会收到通知，可以重新发起分布式锁获取。</p><p>　　<strong>共享锁又称为读锁</strong>，若事务T1对数据对象O1加上共享锁，那么当前事务只能对O1进行读取操作，其他事务也只能对这个数据对象加共享锁，直到该数据对象上的所有共享锁都被释放。</p><p><img src="data:image/png;base64,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" alt="img">　　① <strong>获取锁</strong>，在需要获取共享锁时，所有客户端都会到/shared_lock下面创建一个临时顺序节点，如果是读请求，那么就创建例如/shared_lock/host1-R-00000001的节点，如果是写请求，那么就创建例如/shared_lock/host2-W-00000002的节点。</p><p>　　② <strong>判断读写顺序</strong>，不同事务可以同时对一个数据对象进行读写操作，而更新操作必须在当前没有任何事务进行读写情况下进行，通过Zookeeper来确定分布式读写顺序，大致分为四步。</p><p>　　　　1. 创建完节点后，获取/shared_lock节点下所有子节点，并对该节点变更注册监听。</p><p>　　　　2. 确定自己的节点序号在所有子节点中的顺序。</p><p>　　　　3. 对于读请求：若没有比自己序号小的子节点或所有比自己序号小的子节点都是读请求，那么表明自己已经成功获取到共享锁，同时开始执行读取逻辑，若有写请求，则需要等待。对于写请求：若自己不是序号最小的子节点，那么需要等待。</p><p>　　　　4. 接收到Watcher通知后，重复步骤1。</p><p>　　③ <strong>释放锁</strong>，其释放锁的流程与独占锁一致。</p><p>　　上述共享锁的实现方案，可以满足一般分布式集群竞争锁的需求，但是如果机器规模扩大会出现一些问题，下面着重分析判断读写顺序的步骤3。</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　针对如上图所示的情况进行分析</p><p>　　1. host1首先进行读操作，完成后将节点/shared_lock/host1-R-00000001删除。</p><p>　　2. 余下4台机器均收到这个节点移除的通知，然后重新从/shared_lock节点上获取一份新的子节点列表。</p><p>　　3. 每台机器判断自己的读写顺序，其中host2检测到自己序号最小，于是进行写操作，余下的机器则继续等待。</p><p>　　4. 继续…</p><p>　　可以看到，host1客户端在移除自己的共享锁后，Zookeeper发送了子节点更变Watcher通知给所有机器，然而除了给host2产生影响外，对其他机器没有任何作用。大量的Watcher通知和子节点列表获取两个操作会重复运行，这样会造成系能鞥影响和网络开销，更为严重的是，如果同一时间有多个节点对应的客户端完成事务或事务中断引起节点小时，Zookeeper服务器就会在短时间内向其他所有客户端发送大量的事件通知，这就是所谓的<strong>羊群效应</strong>。</p><p>　　可以有如下改动来避免羊群效应。</p><p>　　1. 客户端调用create接口常见类似于/shared_lock/[Hostname]-请求类型-序号的临时顺序节点。</p><p>　　2. 客户端调用getChildren接口获取所有已经创建的子节点列表（不注册任何Watcher）。</p><p>　　3. 如果无法获取共享锁，就调用exist接口来对比自己小的节点注册Watcher。对于读请求：向比自己序号小的最后一个写请求节点注册Watcher监听。对于写请求：向比自己序号小的最后一个节点注册Watcher监听。</p><p>　　4. 等待Watcher通知，继续进入步骤2。</p><p>　　此方案改动主要在于：每个锁竞争者，只需要关注/shared_lock节点下序号比自己小的那个节点是否存在即可。</p><h4 id="8-分布式队列"><a href="#8-分布式队列" class="headerlink" title="8. 分布式队列"></a>8. 分布式队列</h4><p>​    分布式队列可以简单分为<strong>先入先出队列模型</strong>和<strong>等待队列元素聚集后统一安排处理执行的Barrier模型</strong>。</p><p>　　① <strong>FIFO先入先出</strong>，先进入队列的请求操作先完成后，才会开始处理后面的请求。FIFO队列就类似于全写的共享模型，所有客户端都会到/queue_fifo这个节点下创建一个临时节点，如/queue_fifo/host1-00000001。</p><p><img src="data:image/png;base64,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" alt="img">　　创建完节点后，按照如下步骤执行。</p><p>　　1. 通过调用getChildren接口来获取/queue_fifo节点的所有子节点，即获取队列中所有的元素。</p><p>　　2. 确定自己的节点序号在所有子节点中的顺序。</p><p>　　3. 如果自己的序号不是最小，那么需要等待，同时向比自己序号小的最后一个节点注册Watcher监听。</p><p>　　4. 接收到Watcher通知后，重复步骤1。</p><p>　　② <strong>Barrier分布式屏障</strong>，最终的合并计算需要基于很多并行计算的子结果来进行，开始时，/queue_barrier节点已经默认存在，并且将结点数据内容赋值为数字n来代表Barrier值，之后，所有客户端都会到/queue_barrier节点下创建一个临时节点，例如/queue_barrier/host1。</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　创建完节点后，按照如下步骤执行。</p><p>　　1. 通过调用getData接口获取/queue_barrier节点的数据内容，如10。</p><p>　　2. 通过调用getChildren接口获取/queue_barrier节点下的所有子节点，同时注册对子节点变更的Watcher监听。</p><p>　　3. 统计子节点的个数。</p><p>　　4. 如果子节点个数还不足10个，那么需要等待。</p><p>　　5. 接受到Wacher通知后，重复步骤3。</p>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-数据发布与订阅&quot;&gt;&lt;a href=&quot;#1-数据发布与订阅&quot; class=&quot;headerlink&quot; title=&quot;1. 数据发布与订阅&quot;&gt;&lt;/a&gt;1. 数据发布与订阅&lt;/h4&gt;&lt;p&gt;​    数据发布/订阅系统，即配置中心。需要发布者将数据发布到Zookeeper的节点上，供订阅者进行数据订阅，进而达到动态获取数据的目的，实现配置信息的集中式管理和数据的动态更新。发布/订阅一般有两种设计模式：推模式和拉模式，服务端主动将数据更新发送给所有订阅的客户端称为推模式；客户端主动请求获取最新数据称为拉模式，Zookeeper采用了推拉相结合的模式，客户端向服务端注册自己需要关注的节点，一旦该节点数据发生变更，那么服务端就会向相应的客户端推送Watcher事件通知，客户端接收到此通知后，主动到服务端获取最新的数据。&lt;/p&gt;</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Zookeeper安装</title>
    <link href="https://www.forchanchan.cn/zookeeper-install.html"/>
    <id>https://www.forchanchan.cn/zookeeper-install.html</id>
    <published>2021-01-15T02:05:00.000Z</published>
    <updated>2021-01-15T02:11:36.884Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-下载并解压"><a href="#1-下载并解压" class="headerlink" title="1. 下载并解压"></a>1. 下载并解压</h4><p>​    下载并解压ZooKeeper软件压缩包后，可以看到zk包含以下的文件和目录：</p><p>​    <a id="more"></a></p><p>​    <img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gmlwjs8fjpj30fm0hw400.jpg" alt="这里写图片描述"></p><p>​    ZooKeeper软件的文件和目录</p><ul><li>bin目录<br>zk的可执行脚本目录，包括zk服务进程，zk客户端，等脚本。其中，.sh是Linux环境下的脚本，.cmd是Windows环境下的脚本。</li><li>conf目录<br>配置文件目录。zoo_sample.cfg为样例配置文件，需要修改为自己的名称，一般为zoo.cfg。log4j.properties为日志配置文件。</li><li>lib<br>zk依赖的包。</li><li>contrib目录<br>一些用于操作zk的工具包。</li><li>recipes目录<br>zk某些用法的代码示例</li></ul><h4 id="2-运行配置"><a href="#2-运行配置" class="headerlink" title="2. 运行配置"></a>2. 运行配置</h4><p>​    conf目录下提供了配置的样例zoo_sample.cfg，要将zk运行起来，需要将其名称修改为zoo.cfg。<br>打开zoo.cfg，可以看到默认的一些配置。</p><ul><li>tickTime<br>时长单位为毫秒，为zk使用的基本时间度量单位。例如，1 * tickTime是客户端与zk服务端的心跳时间，2 * tickTime是客户端会话的超时时间。<br>tickTime的默认值为2000毫秒，更低的tickTime值可以更快地发现超时问题，但也会导致更高的网络流量（心跳消息）和更高的CPU使用率（会话的跟踪处理）。</li><li>initLimit<br>ZooKeeper集群模式下包含多个zk进程，其中一个进程为leader，余下的进程为follower。<br>当follower最初与leader建立连接时，它们之间会传输相当多的数据，尤其是follower的数据落后leader很多。initLimit配置follower与leader之间建立连接后进行同步的最长时间。</li><li>syncLimit<br>配置follower和leader之间发送消息，请求和应答的最大时间长度。</li><li>clientPort<br>zk服务进程监听的TCP端口，默认情况下，服务端会监听2181端口。</li><li>dataDir<br>无默认配置，必须配置，用于配置存储快照文件的目录。如果没有配置dataLogDir，那么事务日志也会存储在此目录。</li><li>server.id=host:port1:port2<br>其中id为一个数字，表示zk进程的id，这个id也是dataDir目录下myid文件的内容。<br>host是该zk进程所在的IP地址，port1表示follower和leader交换消息所使用的端口，port2表示选举leader所使用的端口。</li></ul><p>假如我们打算在三台不同的机器 192.168.229.160，192.168.229.161，192.168.229.162上各部署一个zk进程，以构成一个zk集群。<br>三个zk进程均使用相同的 zoo.cfg 配置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tickTime&#x3D;2000</span><br><span class="line">dataDir&#x3D;&#x2F;home&#x2F;myname&#x2F;zookeeper</span><br><span class="line">clientPort&#x3D;2181</span><br><span class="line">initLimit&#x3D;5</span><br><span class="line">syncLimit&#x3D;2</span><br><span class="line">server.1&#x3D;192.168.229.160:2888:3888</span><br><span class="line">server.2&#x3D;192.168.229.161:2888:3888</span><br><span class="line">server.3&#x3D;192.168.229.162:2888:3888</span><br></pre></td></tr></table></figure><p><strong>在三台机器dataDir目录（ /home/myname/zookeeper 目录）下，分别生成一个myid文件，其内容分别为1，2，3</strong></p><p>然后分别在这三台机器上启动zk进程，这样我们便将zk集群启动了起来。</p><h4 id="3-启动"><a href="#3-启动" class="headerlink" title="3. 启动"></a>3. 启动</h4><p>在Windows环境下，直接双击zkServer.cmd即可。在Linux环境下，进入bin目录，执行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;zkServer.sh start</span><br></pre></td></tr></table></figure><p>这个命令使得zk服务进程在后台进行。如果想在前台中运行以便查看服务器进程的输出日志，可以通过以下命令运行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;zkServer.sh start-foreground</span><br></pre></td></tr></table></figure><p>执行此命令，可以看到大量详细信息的输出，以便允许查看服务器发生了什么。</p><h4 id="4-连接"><a href="#4-连接" class="headerlink" title="4. 连接"></a>4. 连接</h4><p>如果是连接同一台主机上的zk进程，那么直接运行bin/目录下的zkCli.cmd（Windows环境下）或者zkCli.sh（Linux环境下），即可连接上zk。<br>直接执行zkCli.cmd或者zkCli.sh命令默认以主机号 127.0.0.1，端口号 2181 来连接zk，如果要连接不同机器上的zk，可以使用 -server 参数，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;zkCli.sh -server 192.168.0.1:2181</span><br></pre></td></tr></table></figure><p>可以使用以下命令来连接一个zk集群：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;zkCli.sh -server 192.168.229.160:2181,192.168.229.161:2181,192.168.229.162:2181</span><br></pre></td></tr></table></figure><h4 id="5-常用命令"><a href="#5-常用命令" class="headerlink" title="5. 常用命令"></a>5. 常用命令</h4><ul><li><p><code>ls</code> 查看命令    </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] ls &#x2F;</span><br><span class="line">[niocoder, zookeeper]</span><br></pre></td></tr></table></figure></li><li><p><code>get</code> 获取节点数据和元数据信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 7] get &#x2F;zookeeper #下面空行说明节点内容为空</span><br><span class="line"></span><br><span class="line">cZxid &#x3D; 0x0</span><br><span class="line">ctime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">mZxid &#x3D; 0x0</span><br><span class="line">mtime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">pZxid &#x3D; 0x0</span><br><span class="line">cversion &#x3D; -1</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 0</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 0</span><br><span class="line">numChildren &#x3D; 1</span><br></pre></td></tr></table></figure></li><li><p><code>stat</code> 获取节点元数据信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 8] stat &#x2F;zookeeper</span><br><span class="line">cZxid &#x3D; 0x0</span><br><span class="line">ctime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">mZxid &#x3D; 0x0</span><br><span class="line">mtime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">pZxid &#x3D; 0x0</span><br><span class="line">cversion &#x3D; -1</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 0</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 0</span><br><span class="line">numChildren &#x3D; 1</span><br></pre></td></tr></table></figure></li><li><p><code>ls2</code> ls命令和stat命令的整合</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 10] ls2 &#x2F;zookeeper</span><br><span class="line">[quota]</span><br><span class="line">cZxid &#x3D; 0x0</span><br><span class="line">ctime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">mZxid &#x3D; 0x0</span><br><span class="line">mtime &#x3D; Thu Jan 01 00:00:00 UTC 1970</span><br><span class="line">pZxid &#x3D; 0x0</span><br><span class="line">cversion &#x3D; -1</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 0</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 0</span><br><span class="line">numChildren &#x3D; 1</span><br></pre></td></tr></table></figure></li><li><p><code>create</code> 创建节点</p><p>create -e 创建临时节点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 4] create -e  &#x2F;merryyou&#x2F;temp merryyou</span><br><span class="line">Created &#x2F;merryyou&#x2F;temp</span><br></pre></td></tr></table></figure><p>create -s 创建顺序节点，自动叠加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">zk: localhost:2181(CONNECTED) 2] create -s &#x2F;merryyou&#x2F;sec seq</span><br><span class="line">Created &#x2F;merryyou&#x2F;sec0000000001</span><br><span class="line">[zk: localhost:2181(CONNECTED) 3] create -s &#x2F;merryyou&#x2F;sec seq</span><br><span class="line">Created &#x2F;merryyou&#x2F;sec0000000002</span><br></pre></td></tr></table></figure></li><li><p><code>set path data</code> 修改节点内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 7] set &#x2F;merryyou new-merryyou</span><br><span class="line">cZxid &#x3D; 0x200000004</span><br><span class="line">ctime &#x3D; Sat Jun 02 14:20:06 UTC 2018</span><br><span class="line">mZxid &#x3D; 0x20000000a</span><br><span class="line">mtime &#x3D; Sat Jun 02 14:29:23 UTC 2018</span><br><span class="line">pZxid &#x3D; 0x200000009</span><br><span class="line">cversion &#x3D; 4</span><br><span class="line">dataVersion &#x3D; 1</span><br><span class="line">aclVersion &#x3D; 0</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 12</span><br><span class="line">numChildren &#x3D; 2</span><br></pre></td></tr></table></figure></li><li><p><code>delete path</code> 删除节点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 13] delete &#x2F;merryyou&#x2F;sec0000000001</span><br></pre></td></tr></table></figure></li><li><p><code>stat path watch</code> 或 <code>get path watch</code>设置watch事件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#添加watch 事件</span><br><span class="line">[zk: localhost:2181(CONNECTED) 18] stat &#x2F;longfei watch</span><br><span class="line">Node does not exist: &#x2F;longfei</span><br><span class="line">#创建longfei节点时触发watcher事件</span><br><span class="line">[zk: localhost:2181(CONNECTED) 19] create &#x2F;longfei test</span><br><span class="line"></span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:NodeCreated path:&#x2F;longfei</span><br></pre></td></tr></table></figure></li><li><p>四字命令</p><p>​    没有nc命令可以通过<code>npm install nc</code>安装，或者<code>telnet</code>后再执行命令</p><ul><li><p><code>stat</code> 查看服务器状态信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# echo stat | nc 192.168.0.68 2181</span><br><span class="line">Zookeeper version: 3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11&#x2F;01&#x2F;2017 18:06 GMT</span><br><span class="line">Clients:</span><br><span class="line"> &#x2F;192.168.0.68:49346[0](queued&#x3D;0,recved&#x3D;1,sent&#x3D;0)</span><br><span class="line"></span><br><span class="line">Latency min&#x2F;avg&#x2F;max: 0&#x2F;0&#x2F;4</span><br><span class="line">Received: 62</span><br><span class="line">Sent: 61</span><br><span class="line">Connections: 1</span><br><span class="line">Outstanding: 0</span><br><span class="line">Zxid: 0x50000000a</span><br><span class="line">Mode: follower</span><br><span class="line">Node count: 10</span><br></pre></td></tr></table></figure></li><li><p><code>conf</code> 查看服务器配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# echo conf | nc 192.168.0.68 2181</span><br><span class="line">clientPort&#x3D;2181</span><br><span class="line">dataDir&#x3D;&#x2F;usr&#x2F;home&#x2F;zookeeper-3.4.11&#x2F;data&#x2F;version-2</span><br><span class="line">dataLogDir&#x3D;&#x2F;usr&#x2F;home&#x2F;zookeeper-3.4.11&#x2F;data&#x2F;version-2</span><br><span class="line">tickTime&#x3D;2000</span><br><span class="line">maxClientCnxns&#x3D;60</span><br><span class="line">minSessionTimeout&#x3D;4000</span><br><span class="line">maxSessionTimeout&#x3D;40000</span><br><span class="line">serverId&#x3D;2</span><br><span class="line">initLimit&#x3D;10</span><br><span class="line">syncLimit&#x3D;5</span><br><span class="line">electionAlg&#x3D;3</span><br><span class="line">electionPort&#x3D;3888</span><br><span class="line">quorumPort&#x3D;2888</span><br><span class="line">peerType&#x3D;0</span><br></pre></td></tr></table></figure></li><li><p><code>mntr</code>  查看zk的健康信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# echo mntr | nc 192.168.0.68 2181</span><br><span class="line">zk_version  3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11&#x2F;01&#x2F;2017 18:06 GMT</span><br><span class="line">zk_avg_latency  0</span><br><span class="line">zk_max_latency  4</span><br><span class="line">zk_min_latency  0</span><br><span class="line">zk_packets_received 68</span><br><span class="line">zk_packets_sent 67</span><br><span class="line">zk_num_alive_connections    1</span><br><span class="line">zk_outstanding_requests 0</span><br><span class="line">zk_server_state follower</span><br><span class="line">zk_znode_count  10</span><br><span class="line">zk_watch_count  0</span><br><span class="line">zk_ephemerals_count 0</span><br><span class="line">zk_approximate_data_size    124</span><br><span class="line">zk_open_file_descriptor_count   32</span><br><span class="line">zk_max_file_descriptor_count    4096</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>ACL权限控制</p><p>ZK的节点有5种操作权限：<code>CREATE</code>、<code>READ</code>、<code>WRITE</code>、<code>DELETE</code>、<code>ADMIN</code> 也就是 增、删、改、查、管理权限，这5种权限简写为<code>crwda</code>(即：每个单词的首字符缩写)。<br>注：这5种权限中，delete是指对子节点的删除权限，其它4种权限指对自身节点的操作权限</p><p>身份的认证有4种方式：<br>- <code>world</code>：默认方式，相当于全世界都能访问<br>- <code>auth</code>：代表已经认证通过的用户(cli中可以通过addauth digest user:pwd 来添加当前上下文中的授权用户)<br>- <code>digest</code>：即用户名:密码这种方式认证，这也是业务系统中最常用的<br>- <code>ip</code>：使用Ip地址认证</p><p>使用<code>[scheme:id:permissions]</code>来表示acl权限</p><ul><li><p><code>getAcl</code> 获取节点的访问权限信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 34] getAcl &#x2F;merryyou</span><br><span class="line">&#39;world,&#39;anyone</span><br><span class="line">: cdrwa</span><br></pre></td></tr></table></figure></li><li><p><code>setAcl</code> 设置节点的权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 37] setAcl &#x2F;merryyou&#x2F;test world:anyone:crwa</span><br><span class="line">cZxid &#x3D; 0x200000018</span><br><span class="line">ctime &#x3D; Sat Jun 02 16:18:18 UTC 2018</span><br><span class="line">mZxid &#x3D; 0x200000018</span><br><span class="line">mtime &#x3D; Sat Jun 02 16:18:18 UTC 2018</span><br><span class="line">pZxid &#x3D; 0x200000018</span><br><span class="line">cversion &#x3D; 0</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 1</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 4</span><br><span class="line">numChildren &#x3D; 0</span><br></pre></td></tr></table></figure></li><li><p>acl auth 明文密码设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] setAcl &#x2F;niocoder&#x2F;merryyou auth:test:test:cdrwa  </span><br><span class="line">Acl is not valid : &#x2F;niocoder&#x2F;merryyou</span><br><span class="line"># 注册test:test 账号密码</span><br><span class="line">[zk: localhost:2181(CONNECTED) 3] addauth digest test:test</span><br><span class="line">[zk: localhost:2181(CONNECTED) 4] setAcl &#x2F;niocoder&#x2F;merryyou auth:test:test:cdrwa</span><br><span class="line">cZxid &#x3D; 0x200000020</span><br><span class="line">ctime &#x3D; Sat Jun 02 16:32:08 UTC 2018</span><br><span class="line">mZxid &#x3D; 0x200000020</span><br><span class="line">mtime &#x3D; Sat Jun 02 16:32:08 UTC 2018</span><br><span class="line">pZxid &#x3D; 0x200000020</span><br><span class="line">cversion &#x3D; 0</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 1</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 8</span><br><span class="line">numChildren &#x3D; 0</span><br></pre></td></tr></table></figure></li><li><p>acl digest 密码密文设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#使用digest设置节点的权限信息 密码为test密文</span><br><span class="line">[zk: localhost:2181(CONNECTED) 15] setAcl &#x2F;names digest:test:V28q&#x2F;NynI4JI3Rk54h0r8O5kMug&#x3D;:cdra</span><br><span class="line">cZxid &#x3D; 0x400000006</span><br><span class="line">ctime &#x3D; Sun Jun 03 01:01:17 UTC 2018</span><br><span class="line">mZxid &#x3D; 0x400000006</span><br><span class="line">mtime &#x3D; Sun Jun 03 01:01:17 UTC 2018</span><br><span class="line">pZxid &#x3D; 0x400000006</span><br><span class="line">cversion &#x3D; 0</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 1</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 4</span><br><span class="line">numChildren &#x3D; 0</span><br><span class="line">#查询节点权限信息</span><br><span class="line">[zk: localhost:2181(CONNECTED) 16] getAcl &#x2F;names</span><br><span class="line">&#39;digest,&#39;test:V28q&#x2F;NynI4JI3Rk54h0r8O5kMug&#x3D;</span><br><span class="line">: cdra</span><br><span class="line">#获取节点信息提示权限不足</span><br><span class="line">[zk: localhost:2181(CONNECTED) 5] get &#x2F;names</span><br><span class="line">Authentication is not valid : &#x2F;names</span><br><span class="line"># 注册账户</span><br><span class="line">[zk: localhost:2181(CONNECTED) 4] addauth digest test:test</span><br><span class="line"># 可以正常获取</span><br></pre></td></tr></table></figure></li><li><p>acl ip 控制客户端</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 添加ip控制的权限信息</span><br><span class="line">[zk: localhost:2181(CONNECTED) 24] setAcl &#x2F;niocoder&#x2F;ip ip:192.168.0.68:cdrwa</span><br><span class="line">cZxid &#x3D; 0x40000000a</span><br><span class="line">ctime &#x3D; Sun Jun 03 01:06:47 UTC 2018</span><br><span class="line">mZxid &#x3D; 0x40000000a</span><br><span class="line">mtime &#x3D; Sun Jun 03 01:06:47 UTC 2018</span><br><span class="line">pZxid &#x3D; 0x40000000a</span><br><span class="line">cversion &#x3D; 0</span><br><span class="line">dataVersion &#x3D; 0</span><br><span class="line">aclVersion &#x3D; 1</span><br><span class="line">ephemeralOwner &#x3D; 0x0</span><br><span class="line">dataLength &#x3D; 2</span><br><span class="line">numChildren &#x3D; 0</span><br><span class="line">[zk: localhost:2181(CONNECTED) 25] getAcl &#x2F;niocoder&#x2F;ip</span><br><span class="line">&#39;ip,&#39;192.168.0.68</span><br><span class="line">: cdrwa</span><br></pre></td></tr></table></figure></li></ul></li></ul>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-下载并解压&quot;&gt;&lt;a href=&quot;#1-下载并解压&quot; class=&quot;headerlink&quot; title=&quot;1. 下载并解压&quot;&gt;&lt;/a&gt;1. 下载并解压&lt;/h4&gt;&lt;p&gt;​    下载并解压ZooKeeper软件压缩包后，可以看到zk包含以下的文件和目录：&lt;/p&gt;
&lt;p&gt;​</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Zookeeper常见问题(FAQ)</title>
    <link href="https://www.forchanchan.cn/zookeeper-faq.html"/>
    <id>https://www.forchanchan.cn/zookeeper-faq.html</id>
    <published>2021-01-15T02:04:00.000Z</published>
    <updated>2021-01-15T02:11:39.386Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-客户端对ServerList-的轮询机制是什么"><a href="#1-客户端对ServerList-的轮询机制是什么" class="headerlink" title="1. 客户端对ServerList 的轮询机制是什么"></a>1. 客户端对ServerList 的轮询机制是什么</h4><p>​    客户端在初始化( new ZooKeeper(String connectString, int sessionTimeout, Watcher watcher) )的过程中，将所有Server保存在一个List中，然后随机打散，形成一个环。之后从0号位开始一个一个使用。<br>两个注意点：</p><ol><li>Server地址能够重复配置，这样能够弥补客户端无法设置Server权重的缺陷，但是也会加大风险。（比如: 192.168.1.1:2181,192.168.1.1:2181,192.168.1.2:2181).</li><li>如果客户端在进行Server切换过程中耗时过长，那么将会收到SESSION_EXPIRED. 这也是上面第1点中的加大风险之处。</li></ol><a id="more"></a><h4 id="2-客户端如何正确处理CONNECTIONLOSS-连接断开-和-SESSIONEXPIRED-Session-过期-两类连接异常"><a href="#2-客户端如何正确处理CONNECTIONLOSS-连接断开-和-SESSIONEXPIRED-Session-过期-两类连接异常" class="headerlink" title="2. 客户端如何正确处理CONNECTIONLOSS(连接断开) 和 SESSIONEXPIRED(Session 过期)两类连接异常"></a>2. 客户端如何正确处理CONNECTIONLOSS(连接断开) 和 SESSIONEXPIRED(Session 过期)两类连接异常</h4><p>​    在ZooKeeper中，服务器和客户端之间维持的是一个长连接，在 SESSION_TIMEOUT 时间内，服务器会确定客户端是否正常连接(客户端会定时向服务器发送heart_beat),服务器重置下次SESSION_TIMEOUT时间。因此，在正常情况下，Session一直有效，并且zk集群所有机器上都保存这个Session信息。在出现问题情况下，客户端与服务器之间连接断了（客户端所连接的那台zk机器挂了，或是其它原因的网络闪断），这个时候客户端会主动在地址列表（初始化的时候传入构造方法的那个参数connectString）中选择新的地址进行连接。</p><p>好了，上面基本就是服务器与客户端之间维持长连接的过程了。在这个过程中，用户可能会看到两类异常CONNECTIONLOSS(连接断开) 和SESSIONEXPIRED(Session 过期)。</p><p>CONNECTIONLOSS发生在上面红色文字部分，应用在进行操作A时，发生了CONNECTIONLOSS，此时用户不需要关心我的会话是否可用，应用所要做的就是等待客户端帮我们自动连接上新的zk机器，一旦成功连接上新的zk机器后，确认刚刚的操作A是否执行成功了。</p><p>SESSIONEXPIRED发生在上面蓝色文字部分，这个通常是zk客户端与服务器的连接断了，试图连接上新的zk机器，这个过程如果耗时过长，超过 SESSION_TIMEOUT 后还没有成功连接上服务器，那么服务器认为这个session已经结束了（服务器无法确认是因为其它异常原因还是客户端主动结束会话），开始清除和这个会话有关的信息，包括这个会话创建的临时节点和注册的Watcher。在这之后，客户端重新连接上了服务器在，但是很不幸，服务器会告诉客户端SESSIONEXPIRED。此时客户端要做的事情就看应用的复杂情况了，总之，要重新实例zookeeper对象，重新操作所有临时数据（包括临时节点和注册Watcher）。</p><h4 id="3-一个客户端修改了某个节点的数据，其它客户端能够马上获取到这个最新数据吗"><a href="#3-一个客户端修改了某个节点的数据，其它客户端能够马上获取到这个最新数据吗" class="headerlink" title="3. 一个客户端修改了某个节点的数据，其它客户端能够马上获取到这个最新数据吗"></a>3. 一个客户端修改了某个节点的数据，其它客户端能够马上获取到这个最新数据吗</h4><p>​    ZooKeeper不能确保任何客户端能够获取（即Read Request）到一样的数据，除非客户端自己要求：方法是客户端在获取数据之前调用org.apache.zookeeper.AsyncCallback.VoidCallback, java.lang.Object) sync.</p><p>通常情况下（这里所说的通常情况满足：1. 对获取的数据是否是最新版本不敏感，2. 一个客户端修改了数据，其它客户端需要不需要立即能够获取最新），可以不关心这点。</p><p>在其它情况下，最清晰的场景是这样：ZK客户端A对 /my_test 的内容从 v1-&gt;v2, 但是ZK客户端B对 /my_test 的内容获取，依然得到的是 v1. 请注意，这个是实际存在的现象，当然延时很短。解决的方法是客户端B先调用 sync(), 再调用 getData()</p><h4 id="4-ZK为什么不提供一个永久性的Watcher注册机制"><a href="#4-ZK为什么不提供一个永久性的Watcher注册机制" class="headerlink" title="4. ZK为什么不提供一个永久性的Watcher注册机制"></a>4. ZK为什么不提供一个永久性的Watcher注册机制</h4><p>​    不支持用持久Watcher的原因很简单，ZK无法保证性能。<br>使用watch需要注意的几点</p><ol><li>Watches通知是一次性的，必须重复注册.</li><li>发生CONNECTIONLOSS之后，只要在session_timeout之内再次连接上（即不发生SESSIONEXPIRED），那么这个连接注册的watches依然在。</li><li>节点数据的版本变化会触发NodeDataChanged，注意，这里特意说明了是版本变化。存在这样的情况，只要成功执行了setData()方法，无论内容是否和之前一致，都会触发NodeDataChanged。</li><li>对某个节点注册了watch，但是节点被删除了，那么注册在这个节点上的watches都会被移除。</li><li>同一个zk客户端对某一个节点注册相同的watch，只会收到一次通知。即 </li><li>Watcher对象只会保存在客户端，不会传递到服务端。</li></ol><h4 id="5-我能否收到每次节点变化的通知"><a href="#5-我能否收到每次节点变化的通知" class="headerlink" title="5.我能否收到每次节点变化的通知"></a>5.我能否收到每次节点变化的通知</h4><p>如果节点数据的更新频率很高的话，不能。 </p><p>原因在于：当一次数据修改，通知客户端，客户端再次注册watch，在这个过程中，可能数据已经发生了许多次数据修改，因此，千万不要做这样的测试：”数据被修改了n次，一定会收到n次通知”来测试server是否正常工作。（我曾经就做过这样的傻事，发现Server一直工作不正常？其实不是）。即使你使用了GitHub上这个客户端也一样。</p><h4 id="6-能为临时节点创建子节点吗"><a href="#6-能为临时节点创建子节点吗" class="headerlink" title="6. 能为临时节点创建子节点吗"></a>6. 能为临时节点创建子节点吗</h4><p>​    不能</p><h4 id="7-是否可以拒绝单个IP对ZK的访问"><a href="#7-是否可以拒绝单个IP对ZK的访问" class="headerlink" title="7. 是否可以拒绝单个IP对ZK的访问"></a>7. 是否可以拒绝单个IP对ZK的访问</h4><p>​    ZK本身不提供这样的功能，它仅仅提供了对单个IP的连接数的限制。你可以通过修改iptables来实现对单个ip的限制，当然，你也可以通过这样的方式来解决。<a href="https://issues.apache.org/jira/browse/ZOOKEEPER-1320">https://issues.apache.org/jira/browse/ZOOKEEPER-1320</a></p><h4 id="8-在getChildren-String-path-boolean-watch-是注册了对节点子节点的变化，那么子节点的子节点变化能通知吗"><a href="#8-在getChildren-String-path-boolean-watch-是注册了对节点子节点的变化，那么子节点的子节点变化能通知吗" class="headerlink" title="8. 在getChildren(String path, boolean watch)是注册了对节点子节点的变化，那么子节点的子节点变化能通知吗"></a>8. 在getChildren(String path, boolean watch)是注册了对节点子节点的变化，那么子节点的子节点变化能通知吗</h4><p>​    不能</p>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-客户端对ServerList-的轮询机制是什么&quot;&gt;&lt;a href=&quot;#1-客户端对ServerList-的轮询机制是什么&quot; class=&quot;headerlink&quot; title=&quot;1. 客户端对ServerList 的轮询机制是什么&quot;&gt;&lt;/a&gt;1. 客户端对ServerList 的轮询机制是什么&lt;/h4&gt;&lt;p&gt;​    客户端在初始化( new ZooKeeper(String connectString, int sessionTimeout, Watcher watcher) )的过程中，将所有Server保存在一个List中，然后随机打散，形成一个环。之后从0号位开始一个一个使用。&lt;br&gt;两个注意点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Server地址能够重复配置，这样能够弥补客户端无法设置Server权重的缺陷，但是也会加大风险。（比如: 192.168.1.1:2181,192.168.1.1:2181,192.168.1.2:2181).&lt;/li&gt;
&lt;li&gt;如果客户端在进行Server切换过程中耗时过长，那么将会收到SESSION_EXPIRED. 这也是上面第1点中的加大风险之处。&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>ZAB协议详解</title>
    <link href="https://www.forchanchan.cn/zab.html"/>
    <id>https://www.forchanchan.cn/zab.html</id>
    <published>2021-01-15T02:03:00.000Z</published>
    <updated>2021-01-15T02:11:41.436Z</updated>
    
    <content type="html"><![CDATA[<p>​        Zookeeper使用了Zookeeper Atomic Broadcast（ZAB，Zookeeper原子消息广播协议）的协议作为其数据一致性的核心算法。ZAB协议是为Zookeeper专门设计的一种<strong>支持崩溃恢复的原子广播协议。</strong></p><a id="more"></a><p>　　Zookeeper依赖ZAB协议来实现分布式数据的一致性，基于该协议，Zookeeper实现了一种主备模式的系统架构来保持集群中各副本之间的数据的一致性，即其使用一个单一的诸进程来接收并处理客户端的所有事务请求，并采用ZAB的原子广播协议，将服务器数据的状态变更以事务Proposal的形式广播到所有的副本进程中，ZAB协议的主备模型架构保证了同一时刻集群中只能够有一个主进程来广播服务器的状态变更，因此能够很好地处理客户端大量的并发请求。</p><p>　　ZAB协议的核心是定义了对于那些会改变Zookeeper服务器数据状态的事务请求的处理方式，即：<strong>所有事务请求必须由一个全局唯一的服务器来协调处理</strong>，这样的服务器被称为Leader服务器，余下的服务器则称为Follower服务器，Leader服务器负责将一个客户端事务请求转化成一个事务Proposal（提议），并将该Proposal分发给集群中所有的Follower服务器，之后Leader服务器需要等待所有Follower服务器的反馈，一旦超过半数的Follower服务器进行了正确的反馈后，那么Leader就会再次向所有的Follower服务器分发Commit消息，要求其将前一个Proposal进行提交。</p><p>　　ZAB一些包括两种基本的模式：<strong>崩溃恢复</strong>和<strong>消息广播</strong>。</p><p>　　当整个服务框架启动过程中或Leader服务器出现网络中断、崩溃退出与重启等异常情况时，ZAB协议就会进入恢复模式并选举产生新的Leader服务器。当选举产生了新的Leader服务器，同时集群中已经有过半的机器与该Leader服务器完成了状态同步之后，ZAB协议就会退出恢复模式，状态同步时指数据同步，用来保证集群在过半的机器能够和Leader服务器的数据状态保持一致。</p><p>　　当集群中已经有过半的Follower服务器完成了和Leader服务器的状态同步，那么整个服务框架就可以进入<strong>消息广播模式，</strong>当一台同样遵守ZAB协议的服务器启动后加入到集群中，如果此时集群中已经存在一个Leader服务器在负责进行消息广播，那么加入的服务器就会自觉地进入<strong>数据恢复模式：找到Leader所在的服务器，并与其进行数据同步，然后一起参与到消息广播流程中去。</strong>Zookeeper只允许唯一的一个Leader服务器来进行事务请求的处理，Leader服务器在接收到客户端的事务请求后，会生成对应的事务提议并发起一轮广播协议，而如果集群中的其他机器收到客户端的事务请求后，那么这些非Leader服务器会首先将这个事务请求转发给Leader服务器。</p><p>　　当Leader服务器出现崩溃或者机器重启、集群中已经不存在过半的服务器与Leader服务器保持正常通信时，那么在重新开始新的一轮的原子广播事务操作之前，所有进程首先会使用崩溃恢复协议来使彼此到达一致状态，于是整个ZAB流程就会从消息广播模式进入到崩溃恢复模式。一个机器要成为新的Leader，必须获得过半机器的支持，同时由于每个机器都有可能会崩溃，因此，ZAB协议运行过程中，前后会出现多个Leader，并且每台机器也有可能会多次成为Leader，进入崩溃恢复模式后，只要集群中存在过半的服务器能够彼此进行正常通信，那么就可以产生一个新的Leader并再次进入消息广播模式。如一个由三台机器组成的ZAB服务，通常由一个Leader、2个Follower服务器组成，某一个时刻，加入其中一个Follower挂了，整个ZAB集群是不会中断服务的。</p><p>　　① <strong>消息广播</strong>，ZAB协议的消息广播过程使用原子广播协议，类似于一个二阶段提交过程，针对客户端的事务请求，Leader服务器会为其生成对应的事务Proposal，并将其发送给集群中其余所有的机器，然后再分别收集各自的选票，最后进行事务提交。</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　在ZAB的二阶段提交过程中，移除了中断逻辑，所有的Follower服务器要么正常反馈Leader提出的事务Proposal，要么就抛弃Leader服务器，同时，ZAB协议将二阶段提交中的中断逻辑移除意味着我们可以在过半的Follower服务器已经反馈Ack之后就开始提交事务Proposal，而不需要等待集群中所有的Follower服务器都反馈响应，但是，在这种简化的二阶段提交模型下，无法处理Leader服务器崩溃退出而带来的数据不一致问题，因此ZAB采用了崩溃恢复模式来解决此问题，另外，整个消息广播协议是基于具有FIFO特性的TCP协议来进行网络通信的，因此能够很容易保证消息广播过程中消息接受与发送的顺序性。再整个消息广播过程中，Leader服务器会为每个事务请求生成对应的Proposal来进行广播，并且在广播事务Proposal之前，Leader服务器会首先为这个事务Proposal分配一个全局单调递增的唯一ID，称之为事务ID（ZXID），由于ZAB协议需要保证每个消息严格的因果关系，因此必须将每个事务Proposal按照其ZXID的先后顺序来进行排序和处理。</p><p>　　② <strong>崩溃恢复</strong>，在Leader服务器出现崩溃，或者由于网络原因导致Leader服务器失去了与过半Follower的联系，那么就会进入崩溃恢复模式，在ZAB协议中，为了保证程序的正确运行，整个恢复过程结束后需要选举出一个新的Leader服务器，因此，ZAB协议需要一个高效且可靠的Leader选举算法，从而保证能够快速地选举出新的Leader，同时，Leader选举算法不仅仅需要让Leader自身知道已经被选举为Leader，同时还需要让集群中的所有其他机器也能够快速地感知到选举产生的新的Leader服务器。</p><p>　　③ <strong>基本特性</strong>，ZAB协议规定了如果一个事务Proposal在一台机器上被处理成功，那么应该在所有的机器上都被处理成功，哪怕机器出现故障崩溃。<strong>ZAB协议需要确保那些已经在Leader服务器上提交的事务最终被所有服务器都提交</strong>，假设一个事务在Leader服务器上被提交了，并且已经得到了过半Follower服务器的Ack反馈，但是在它Commit消息发送给所有Follower机器之前，Leader服务挂了。如下图所示</p><p><img src="data:image/png;base64,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" alt="img"></p><p>　　在集群正常运行过程中的某一个时刻，Server1是Leader服务器，其先后广播了P1、P2、C1、P3、C2（C2是Commit Of Proposal2的缩写），其中，当Leader服务器发出C2后就立即崩溃退出了，针对这种情况，ZAB协议就需要确保事务Proposal2最终能够在所有的服务器上都被提交成功，否则将出现不一致。</p><p>　　<strong>ZAB协议需要确保丢弃那些只在Leader服务器上被提出的事务</strong>。如果在崩溃恢复过程中出现一个需要被丢弃的提议，那么在崩溃恢复结束后需要跳过该事务Proposal，如下图所示</p><p><img src="data:image/png;base64,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gZUik0RABERABERgwATkHwy4ApS9CIiACIiACDSQgPyDBlaKTBIBERABERCBAROQfzDgClD2IiACIiACItBAAvIPGlgpMkkEREAEREAEBkxA/sGAK0DZi4AIiIAIiEADCcg/aGClyCQREAEREAERGDAB+QcDrgBlLwIiIAIiIAINJCD/oIGVIpNEQAREQAREYMAE5B8MuAKUvQiIgAiIgAg0kID8gwZWikwSAREQAREQgQETkH8w4ApQ9iIgAiIgAiLQQALyDxpYKTJJBERABERABAZMQP7BgCtA2YuACIiACIhAAwnIP2hgpcgkERABERABERgwAfkHA64AZS8CIiACIiACDSQg/6CBlSKTREAEREAERGDABOQfDLgClL0IiIAIiIAINJCA/IMGVopMEgEREAEREIEBE5B/MOAKUPYiIAIiIAIi0EAC8g8aWCkySQREQAREQAQGTED+wYArQNmLgAiIgAiIQAMJyD9oYKXIJBEQAREQAREYMAH5BwOuAGUvAiIgAiIgAg0kIP+ggZUik0RABERABERgwATkHwy4ApS9CIiACIiACDSQgPyDBlaKTBIBERABERCBAROQfzDgClD2IiACIiACItBAAvIPGlgpMkkEREAEREAEBkxA/sGAK0DZi4AIiIAIiEADCcg/aGClyCQREAEREAERGDAB+QcDrgBlLwIiIAIiIAINJCD/oIGVIpNEQAREQAREYMAEJpbJ//Tp07t27XrjjTeOHDly6tSpY8eOnTlzpkzC8ZGZOHHi9OnTJ0+ePHPmzMWLFy9ZsmTSpEnjU3yVVARGhoCau7ZVqeauLaLREJhw9uzZgpJ8++2369evf/7552fPnn3nnXfyd8qUKTwIuT4KUo3hKRwm3KaTJ08ePHhw+/btH3/88apVqx566CE8hjGkoSKLwDASUHNXstbU3JUENexiRf7BZ599tmjRogULFjz22GO8Fg97UftpPx0tTz311N69e3fs2DFnzpx+Zq28REAEuiCg5q4LaJZEzV3X6JqekP6DzGPfvn1Tp07duXNn5llFliHw7rvvwhAXoYywZERABAZFQM1d7+TV3PXOsGkasvsPcKUXLlyIc6B33x79u8OHD0NSvQg9YlRyEaiPgJq7qtiquauKZEP0ZPgHDMLNmjVr48aNTLJriJVDbQajDCtWrDh06JDmIgx1Pcr4kSSg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" alt="img">　　假设初始的Leader服务器Server1在提出一个事务Proposal3之后就崩溃退出了，从而导致集群中的其他服务器都没有收到这个事务Proposal，于是，当Server1恢复过来再次加入到集群中的时候，ZAB协议需要确保丢弃Proposal3这个事务。</p><p>　　在上述的崩溃恢复过程中需要处理的特殊情况，就决定了ZAB协议必须设计这样的Leader选举算法：能够确保提交已经被Leader提交的事务的Proposal，同时丢弃已经被跳过的事务Proposal。如果让Leader选举算法能够保证新选举出来的Leader服务器拥有集群中所有机器最高编号（ZXID最大）的事务Proposal，那么就可以保证这个新选举出来的Leader一定具有所有已经提交的提议，更为重要的是如果让具有最高编号事务的Proposal机器称为Leader，就可以省去Leader服务器查询Proposal的提交和丢弃工作这一步骤了。</p><p>　　④ <strong>数据同步</strong>，完成Leader选举后，在正式开始工作前，Leader服务器首先会确认日志中的所有Proposal是否都已经被集群中的过半机器提交了，即是否完成了数据同步。Leader服务器需要确所有的Follower服务器都能够接收到每一条事务Proposal，并且能够正确地将所有已经提交了的事务Proposal应用到内存数据库中。Leader服务器会为每个Follower服务器维护一个队列，并将那些没有被各Follower服务器同步的事务以Proposal消息的形式逐个发送给Follower服务器，并在每一个Proposal消息后面紧接着再发送一个Commit消息，以表示该事务已经被提交，等到Follower服务器将所有其尚未同步的事务Proposal都从Leader服务器上同步过来并成功应用到本地数据库后，Leader服务器就会将该Follower服务器加入到真正的可用Follower列表并开始之后的其他流程。</p><p>　　下面分析ZAB协议如何处理需要丢弃的事务Proposal的，ZXID是一个64位的数字，其中32位可以看做是一个简单的单调递增的计数器，针对客户端的每一个事务请求，Leader服务器在产生一个新的事务Proposal时，都会对该计数器进行加1操作，而高32位则代表了Leader周期epoch的编号，每当选举产生一个新的Leader时，就会从这个Leader上取出其本地日志中最大事务Proposal的ZXID，并解析出epoch值，然后加1，之后以该编号作为新的epoch，低32位则置为0来开始生成新的ZXID，ZAB协议通过epoch号来区分Leader周期变化的策略，能够有效地避免不同的Leader服务器错误地使用不同的ZXID编号提出不一样的事务Proposal的异常情况。<strong>当一个包含了上一个Leader周期中尚未提交过的事务Proposal的服务器启动时，其肯定无法成为Leader，因为当前集群中一定包含了一个Quorum（过半）集合，该集合中的机器一定包含了更高epoch的事务的Proposal，因此这台机器的事务Proposal并非最高，也就无法成为Leader。</strong></p><p>　</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;​        Zookeeper使用了Zookeeper Atomic Broadcast（ZAB，Zookeeper原子消息广播协议）的协议作为其数据一致性的核心算法。ZAB协议是为Zookeeper专门设计的一种&lt;strong&gt;支持崩溃恢复的原子广播协议。&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Zookeeper运维经验</title>
    <link href="https://www.forchanchan.cn/zookeeper-experience.html"/>
    <id>https://www.forchanchan.cn/zookeeper-experience.html</id>
    <published>2021-01-15T02:02:00.000Z</published>
    <updated>2021-01-15T02:11:40.567Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-集群数量的设定"><a href="#1-集群数量的设定" class="headerlink" title="1. 集群数量的设定"></a>1. 集群数量的设定</h4><p>​    3台起，如果是虚拟机，必须分散在不同的宿主机上，以实现容灾的目的。如果长远来看（如2-3年）需求会持续增长，可以直接部署5台。ZooKeeper集群扩容是比较麻烦的事情，因此宁可前期稍微浪费一点。</p><a id="more"></a><ol start="2"><li><strong>客户端配置域名而不是 IP</strong></li></ol><p>如果有一天你的 ZooKeeper 集群需要做机房迁移，或者其中几个节点机器挂了，需要更换。让你的用户更新 ZooKeeper 服务器配置不是件轻松的事情，因此一开始就配置好域名，到时候更新 DNS 即可。</p><h4 id="3-开启-autopurge-snapRetainCount"><a href="#3-开启-autopurge-snapRetainCount" class="headerlink" title="3. 开启 autopurge.snapRetainCount"></a>3. <strong>开启 autopurge.snapRetainCount</strong></h4><p>ZooKeeper 默认不会自动清理 tx log，所以总会有一天你会收到磁盘报警（如果你有磁盘监控的话）。开启自动清理机制后，就不用担心了，我的配置如下：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">autopurge.snapRetainCount&#x3D;500</span><br><span class="line"></span><br><span class="line">autopurge.purgeInterval&#x3D;24</span><br></pre></td></tr></table></figure><h4 id="4-集群扩容"><a href="#4-集群扩容" class="headerlink" title="4. 集群扩容"></a>4. 集群扩容</h4><p>如果你可以接受停止服务半个小时，那基本随意玩了，但在比较严肃的环境下，还是不能停服务的。我的做法是这样的：</p><ol><li>有节点 A, B, C 处于服务状态</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.3&#x3D;192.168.12.1:2888:3888</span><br><span class="line"></span><br><span class="line">server.4&#x3D;192.168.12.2:2888:3888</span><br><span class="line"></span><br><span class="line">server.5&#x3D;192.168.12.3:2888:3888</span><br></pre></td></tr></table></figure><ol start="2"><li>加入节点 D，配置如下：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server.3&#x3D;192.168.12.1:2888:3888</span><br><span class="line"></span><br><span class="line">server.4&#x3D;192.168.12.2:2888:3888</span><br><span class="line"></span><br><span class="line">server.5&#x3D;192.168.12.3:2888:3888</span><br><span class="line"></span><br><span class="line">server.6&#x3D;192.168.12.4:2888:3888</span><br><span class="line"></span><br><span class="line">server.7&#x3D;192.168.12.5:2888:3888</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>用 4 字命令检查，保证该节点同步完毕集群数据，处于 Follower 状态：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">echo srvr | nc 192.168.12.4 2181</span><br><span class="line"></span><br><span class="line">Zookeeper version: 3.4.5-1392090, built on 09&#x2F;30&#x2F;2012 17:52 GMT</span><br><span class="line"></span><br><span class="line">Latency min&#x2F;avg&#x2F;max: 0&#x2F;0&#x2F;13432</span><br><span class="line"></span><br><span class="line">Received: ***</span><br><span class="line"></span><br><span class="line">Sent: ***</span><br><span class="line"></span><br><span class="line">Connections: ***</span><br><span class="line"></span><br><span class="line">Outstanding: 0</span><br><span class="line"></span><br><span class="line">Zxid: 0x***</span><br><span class="line"></span><br><span class="line">Mode: follower</span><br><span class="line"></span><br><span class="line">Node count: ***</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>需要注意的是，这一步加入的节点的 id，必须大于集群中原有的节点的 id，例如 6 &gt; 3,4,5，我也不知道为什么需要这样。</p><ol start="3"><li><p>同上一步一样，加入节点 E</p></li><li><p>更新 A B C 的配置如 D 和 E，并依此重启</p></li></ol><h4 id="5-机房迁移"><a href="#5-机房迁移" class="headerlink" title="5. 机房迁移"></a>5. <strong>机房迁移</strong></h4><p>​    例如要把服务从 X 机房的 A B C 迁移到 Y 机房的 A’ B’ C’。做法是首先把集群扩容成包含6个节点的集群；然后修改域名指向让用户的连接都转到 A’ B’ C’；最后更新集群配置，把 A B C 从集群摘除</p><h4 id="6-跨机房容灾"><a href="#6-跨机房容灾" class="headerlink" title="6. 跨机房容灾"></a>6. <strong>跨机房容灾</strong></h4><p>​    由于 ZooKeeper 天生不喜欢偶数（怕脑裂），因此有条件的就三机房部署，但机房之间的网络条件得是类似局域网的条件，否则性能就堪忧了。</p><p>​    双机房做自动容灾基本不可能，加入手动步骤是可以的，和 DB 一样，短时间不可用，立刻启用另外一个机房，平时保证数据同步。</p><p>​    三机房部署，如果一个机房离的比较远，网络延迟较高怎么办？可以 3 + 3 + 1 部署，1 就放在那个网络延迟较高的地方，确保 leader 在 3 + 3 这两个机房中间，那么平时的性能就能保证了。怎么保证 leader 不到 1 呢？目前能想到的办法就是如果发现就重启它。</p><h4 id="7-集群收缩（5-3）"><a href="#7-集群收缩（5-3）" class="headerlink" title="7. 集群收缩（5-3）"></a>7. 集群收缩（5-3）</h4><p>​    修改保留节点的配置后依次重启，重启完成后依次关闭2个不需要的节点即可。</p>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-集群数量的设定&quot;&gt;&lt;a href=&quot;#1-集群数量的设定&quot; class=&quot;headerlink&quot; title=&quot;1. 集群数量的设定&quot;&gt;&lt;/a&gt;1. 集群数量的设定&lt;/h4&gt;&lt;p&gt;​    3台起，如果是虚拟机，必须分散在不同的宿主机上，以实现容灾的目的。如果长远来看（如2-3年）需求会持续增长，可以直接部署5台。ZooKeeper集群扩容是比较麻烦的事情，因此宁可前期稍微浪费一点。&lt;/p&gt;</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Zookeeper初识</title>
    <link href="https://www.forchanchan.cn/to-know-zookeeper.html"/>
    <id>https://www.forchanchan.cn/to-know-zookeeper.html</id>
    <published>2021-01-15T02:00:00.000Z</published>
    <updated>2021-01-15T02:11:42.375Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-Zookeeper是什么"><a href="#1-Zookeeper是什么" class="headerlink" title="1.  Zookeeper是什么"></a>1.  Zookeeper是什么</h4><ul><li><p>分布式的分布式应用程序协调服务</p></li><li><p>解决了数据一致性的问题</p></li><li><p>文件系统 + 监控通知</p><a id="more"></a></li></ul><h4 id="2-Zookeeper数据结构"><a href="#2-Zookeeper数据结构" class="headerlink" title="2. Zookeeper数据结构"></a>2. Zookeeper数据结构</h4><p>​    基于节点的数据存储方式，也叫Znode</p><p>​    Znode里面包含了以下数据</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml52d88yrj30f70ceacc.jpg" alt="57187BB2-EE34-4900-8609-F9CA016D09B3">    </p><p> data: Znode存储的数据信息</p><p> ACL: 记录Znode的访问权限，哪些人或哪些ip可以访问这个节点</p><p>child: 当前节点的子节点引用，类似于二叉树的左孩子右孩子</p><p>stat：存储了Znode的各种元数据，包括版本号，子节点数，数据长度，创建时间等信息 </p><p>​    （通过stat或ls2命令查询）</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml5rvius9j30ki0dgmyt.jpg" alt="image-20210112195635037"></p><p>cZxid: 数据节点创建时的事务ID</p><p>cTime: 数据节点的创建时间</p><p>mZxid: 数据节点修改时的事务ID</p><p>mtime: 数据节点最后修改时间</p><p>pZxid: 数据节点的子节点列表最后一次被修改（是子节点列表变更，而不是子节点内容变更）时的事务ID        </p><p>cversion:  子节点的版本号</p><p>dataVersion: 数据节点的版本号</p><p>aclVersion: 数据节点的ACL版本号</p><p>ephemeralOwner: 如果是临时节点，记录的是创建该节点的会话SessionId; 如果是持久节点，存储的是0x0</p><p>dataLength: 存储的数据长度，最大不能超过1M</p><p>numChildren: 子节点的数量</p><p>Znode的类型分为四种：</p><ul><li><p>PERSISTENT-持久化节点 </p><p>客户端与zookeeper断开连接后，该节点依旧存在 </p></li><li><p>PERSISTENT_SEQUENTIAL-持久化顺序编号目录节点 </p><p>客户端与zookeeper断开连接后，该节点依旧存在，只是Zookeeper给该节点名称进行顺序编号 </p></li><li><p>EPHEMERAL-临时目录节点 </p><p>客户端与zookeeper断开连接后，该节点被删除 </p></li><li><p>EPHEMERAL_SEQUENTIAL-临时顺序编号目录节点 </p><p>客户端与zookeeper断开连接后，该节点被删除，只是Zookeeper给该节点名称进行顺序编号 </p></li></ul><h4 id="3-Zookeeper的角色"><a href="#3-Zookeeper的角色" class="headerlink" title="3. Zookeeper的角色"></a>3. Zookeeper的角色</h4><p>​    <img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml60m458pj30fx075jt7.jpg" alt="39CB74BF-6635-445A-97A0-C4305F6F6D7B"></p><h4 id="4-Zookeeper的工作原理"><a href="#4-Zookeeper的工作原理" class="headerlink" title="4. Zookeeper的工作原理"></a>4. Zookeeper的工作原理</h4><p>​    Zookeeper的核心是ZAB协议（Zookeeper Atomic Broadcast，Zookeeper原子消息广播协议），该协议是其数据一致性的核心算法，是一个专门为Zookeeper设计的支持崩溃恢复的数据广播协议</p><p>​    Zab协议有两种模式，<strong>数据广播模式（同步）和崩溃恢复模式（选主）</strong></p><p>​    当服务器启动或者leader崩溃重启的时候就会进入恢复模式，通过选举算法选出新的leader，当新的leader选举出来，且超过半数的server完成和leader的状态同步后，恢复模式就结束了</p><p>​    为了保证事务的顺序一致性，zookeeper采用了递增的事务id号（zxid）来标识事务。所有的提议（proposal）都在被提出的时候加上了zxid。实现中zxid是一个64位的数字，它高32位是epoch用来标识leader关系是否改变，每次一个leader被选出来，它都会有一个新的epoch，标识当前属于那个leader的统治时期。低32位用于递增计数。</p><ul><li>数据广播模式<ol><li>客户端发起一个事务请求（写操作）</li><li>如果请求的是Follower，则会转发给Leader进行处理，Leader把该请求转化为事务（proposal）提案，并分配一个全局唯一的有序性Zxid</li><li>Leader与每个Follower之间都有一个队列，Leader把事务放入队列</li><li>Follwer从队列取出消息处理完后（写入本地事务日志），向Leader服务器发送Ack确认</li><li>Leader收到半数以上的ACK确认后，认为可以发送Commit</li><li>leader向所有的服务器发送Commit消息</li></ol></li></ul><p>​        只要有一台服务器提交了proposal，就要确保所有的服务器最终都能正确提交proposal。</p><p>​        Zookeeper的数据同步方式和二阶段提交方式有所相同但又不同，二阶段提交方式要求所有的参与者都发送ACK信息后，才能发送Commit消息，要么全部成功，要么全部失败，会产生严重的堵塞问题。</p><p>​        为了进一步防止阻塞，leader服务器与每个follower之间都有一个单独的队列进行收发消息，使用队列消息可以做到异步解耦。leader和follower之间只要往队列中发送了消息即可。如果使用同步方式容易引起阻塞。性能上要下降很多。</p><p>​        </p><ul><li><p>崩溃恢复模式</p><p>当leader崩溃重启或者失去了半数以上的follower的时候，zookeeper会进入恢复模式，通过选举算法选出新的leader，选举算法分为两种：一种是基于basic paxos实现，另外一种是基于fast paxos实现的，系统默认算法为fast paxos算法。</p></li></ul><p>  ZAB协议崩溃恢复要求满足如下2个要求：</p><ul><li><p>确保已经被leader提交的proposal必须最终被所有的follower服务器提交。</p></li><li><p>确保丢弃已经被leader提出的但是没有被提交的proposal。</p><p>新选举出来的leader不能包含未提交的proposal，即新选举的leader必须都是已经提交了的proposal的follower服务器节点。同时，新选举的leader节点中含有最高的ZXID。这样做的好处就是可以避免了leader服务器检查proposal的提交和丢弃工作。</p></li><li><p>每个Server会发出一个投票,第一次都是投自己。投票信息：（myid，ZXID）</p></li><li><p>收集来自各个服务器的投票</p></li><li><p>处理投票并重新投票，处理逻辑：优先比较ZXID,然后比较myid</p></li><li><p>统计投票，只要超过半数的机器接收到同样的投票信息，就可以确定leader</p></li><li><p>更新服务器状态</p></li></ul><p>  **basic paxos: **</p><p>  1.选举线程由当前Server发起选举的线程担任，其主要功能是对投票结果进行统计，并选出推荐的Server； </p><p>  2.选举线程首先向所有Server发起一次询问(包括自己)； </p><p>  3.选举线程收到回复后，验证是否是自己发起的询问(验证zxid是否一致)，然后获取对方的id(myid)，并存储到当前询问对象列表中，最后获取对方提议的leader相关信息(id,zxid)，并将这些信息存储到当次选举的投票记录表中； </p><p>  4.收到所有Server回复以后，就计算出zxid最大的那个Server，并将这个Server相关信息设置成下一次要投票的Server； </p><p>  5.线程将当前zxid最大的Server设置为当前Server要推荐的Leader，如果此时获胜的Server获得n/2 + 1的Server票数，设置当前推荐的leader为获胜的Server，将根据获胜的Server相关信息设置自己的状态，否则，继续这个过程，直到leader被选举出来。 通过流程分析我们可以得出：要使Leader获得多数Server的支持，则Server总数必须是奇数2n+1，且存活的Server的数目不得少于n+1. 每个Server启动后都会重复以上流程。在恢复模式下，如果是刚从崩溃状态恢复的或者刚启动的server还会从磁盘快照中恢复数据和会话信息，zk会记录事务日志并定期进行快照，方便在恢复时进行状态恢复。</p><p>  选主的具体流程图所示： </p><p>  <img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml7nuzdoyj309x0lzjtp.jpg" alt="054FF42F-6F6A-4DBD-AB23-A441A51F8B85"></p><p>​    <strong>fast paxos:</strong></p><p>​        在选举过程中，某Server首先向所有Server提议自己要成为Leader，当其它Server收到提议以后，解决epoch和 zxid的冲突，并接受对方的提议，然后向对方发送接受提议完成的消息，重复这个流程，最后一定能选举出Leader。</p><p>用文字描述就是：</p><p>（1）全天下我最牛，在我没有发现比我牛的推荐人的情况下，我就一直推举我当Leader。第一次投票那必须推举我自己当Leader。</p><p>（2）每当我接收到其它的被推举者，我都要回馈一个信息，表明我还是不是推举我自己。如果被推举者没我大，我就一直推举我当Leader，是我是我还是我！</p><p>（3）我有一个票箱， 和我属于同一轮的投票情况都在这个票箱里面。一人一票 重复的或者过期的票，我都不接受。</p><p>（4）一旦我不再推举我自己了（这时我发现别人推举的人比我推荐的更牛），我就把我的票箱清空，重新发起一轮投票（这时我的票箱一定有两票了，都是选的我认为最牛的人）。</p><p>（5）一旦我发现收到的推举信息中投票轮要高于我的投票轮，我也要清空我的票箱。并且还是投当初我觉得最牛的那个人（除非当前的人比我最初的推荐牛，我就顺带更新我的推荐）。</p><p>（6）不断的重复上面的过程，不断的告诉别人“我的投票是第几轮”、“我推举的人是谁”。直到我的票箱中“我推举的最牛的人”收到了不少于 N /2 + 1的推举投票。</p><p>（7）这时我就可以决定我是flower还是Leader了（如果至始至终都是我最牛，那我就是Leader咯，其它情况就是Follower咯）。并且不论随后收到谁的投票，都向它直接反馈“我的结果”。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml7p9hr1uj30nz0z3q58.jpg" alt="8775426-dc8941fb29c7a7f6"></p><p><strong>选举场景：</strong></p><p>1、集群启动的时候发起leader选举</p><p>​        <img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml872v431j30ii0elq43.jpg"></p><p>  集群刚启动的时候，都把投票投给自己，（1,1）的第一位数代表被推荐的服务器的myid, 第二位数代表被推荐的服务器的zxid， 此时Server1的票箱为（1,1），Server2的票箱为（2, 1），Server3的票箱为（3, 1）</p><p>​    <img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml8atc7glj30ii0eln06.jpg" alt="20200925122501396"></p><p>​        此时收集来自各个服务器的选票，server1收到了来自server2 的（2, 1）和server3的(3, 1)，在zxid相同的情况下选择myid最大的，所以server1把自己的投票更新为(3, 1)， 更新完后把投票广播出去。</p><p>​    根据上述投票，三个服务器一致认为server3应该是Leader，所以server1和server2进入following状态，server3进入leading状态， 并发起维护与follower之间的心跳</p><p> 2、follower崩溃重启</p><p>​    follower重启后会自动进入Looking状态并发起一轮新的投票，并且把投票投给自己</p><p>​    服务器3收到服务器1的投票后，将自己的状态LEADING以及选票返回给服务器1。服务器2收到服务器1的投票后，将自己的状态FOLLOWING及选票返回给服务器1。此时服务器1知道服务器3是Leader，并且通过服务器2与服务器3的选票可以确定服务器3确实得到了超过半数的选票。因此服务器1进入FOLLOWING状态。</p><pre><code> ![20200925122524511](https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml8jexsucj30ii0el77n.jpg)</code></pre><p>3、Leader崩溃重启</p><p>​    Leader（服务器3）宕机后，Follower（服务器1和2）发现Leader不工作了，因此进入LOOKING状态并发起新的一轮投票，并且都将票投给自己。依据场景1的算法进行选举出新的leader</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml8ke0p3nj30ii0eldio.jpg" alt="20200925122546114"></p><p>4、旧leader恢复成为follower</p><p>​        跟场景2一样，旧的Leader恢复后，进入LOOKING状态并发起新一轮领导选举，并将选票投给自己。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gml8mz62yzj30ii0eladk.jpg" alt="20200925122646992"></p><p>选完Leader以后，zookeeper就进入状态同步过程。 </p><ol><li><p>Leader等待server连接； </p><p>2 .Follower连接leader，将最大的zxid发送给leader； </p><p>3 .Leader根据follower的zxid确定同步点； </p><p>4 .完成同步后通知follower 已经成为uptodate状态； </p><p>5 .Follower收到uptodate消息后，又可以重新接受client的请求进行服务了。</p></li></ol><h4 id="5-Zookeeper常用场景"><a href="#5-Zookeeper常用场景" class="headerlink" title="5. Zookeeper常用场景"></a>5. Zookeeper常用场景</h4><ul><li><p>命名服务</p><p>根据指定名字来获取资源或服务的地址，提供者等信息，利用其znode的特点和watcher机制，将其作为动态注册和获取服务信息的配置中心，统一管理服务名称和其对应的服务器列表信息，我们能够近乎实时地感知到后端服务器的状态(上线、下线、宕机)。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gmlvlaxseoj31jj0dp0yv.jpg" alt="流程图"></p></li><li><p>配置管理</p><p>程序总是需要配置的，如果程序分散部署在多台机器上，要逐个改变配置就变得困难。现在把这些配置全部放到zookeeper上去，保存在 Zookeeper 的某个目录节点中，然后所有相关应用程序对这个目录节点进行监听，一旦配置信息发生变化，每个应用程序就会收到 Zookeeper 的通知，然后从 Zookeeper 获取新的配置信息应用到系统中就好。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gmlvlq649dj30ep08v0t4.jpg" alt="A3420D84-1718-4209-9AB9-98C88AF5AA1F"></p></li><li><p>集群管理</p><p>所谓集群管理无在乎两点：是否有机器退出和加入、选举master。 </p><p>对于第一点，所有机器约定在父目录GroupMembers下创建临时目录节点，然后监听父目录节点的子节点变化消息。一旦有机器挂掉，该机器与 zookeeper的连接断开，其所创建的临时目录节点被删除，所有其他机器都收到通知：某个兄弟目录被删除，于是，所有人都知道：它上船了。</p><p>新机器加入也是类似，所有机器收到通知：新兄弟目录加入，highcount又有了，对于第二点，我们稍微改变一下，所有机器创建临时顺序编号目录节点，每次选取编号最小的机器作为master就好。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gmlvmeytxhj30ep09pdg4.jpg" alt="8E7C83EB-B541-465A-86B7-EF0B31B0605A"></p></li><li><p>分布式锁</p><p>锁服务可以分为两类，一个是保持独占，另一个是控制时序。 </p><p>对于第一类，我们将zookeeper上的一个znode看作是一把锁，通过createznode的方式来实现。所有客户端都去创建 /distribute_lock 节点，最终成功创建的那个客户端也即拥有了这把锁。用完删除掉自己创建的distribute_lock 节点就释放出锁。 </p><p>对于第二类， /distribute_lock 已经预先存在，所有客户端在它下面创建临时顺序编号目录节点，和选master一样，编号最小的获得锁，用完删除，依次方便。</p><p><img src="https://cdn.jsdelivr.net/gh/chanislittlepig/chanislittlepig.github.io@images/img/008eGmZEgy1gmlvmqnrzkj30ca0dfq3l.jpg" alt="EB1D6E99-EEEF-42FE-BC3D-8467883A19DD"></p></li><li><p>队列管理</p><p>两种类型的队列：</p><p>1、同步队列，当一个队列的成员都聚齐时，这个队列才可用，否则一直等待所有成员到达。 </p><p>2、队列按照 FIFO 方式进行入队和出队操作。 </p><p>第一类，在约定目录下创建临时目录节点，监听节点数目是否是我们要求的数目。 </p><p>第二类，和分布式锁服务中的控制时序场景基本原理一致，入列有编号，出列按编号。</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-Zookeeper是什么&quot;&gt;&lt;a href=&quot;#1-Zookeeper是什么&quot; class=&quot;headerlink&quot; title=&quot;1.  Zookeeper是什么&quot;&gt;&lt;/a&gt;1.  Zookeeper是什么&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;分布式的分布式应用程序协调服务&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;解决了数据一致性的问题&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;文件系统 + 监控通知&lt;/p&gt;</summary>
    
    
    
    
    <category term="zookeeper" scheme="https://www.forchanchan.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客搭建过程</title>
    <link href="https://www.forchanchan.cn/hexo-begin.html"/>
    <id>https://www.forchanchan.cn/hexo-begin.html</id>
    <published>2021-01-13T06:00:05.000Z</published>
    <updated>2021-01-15T02:11:43.727Z</updated>
    
    <content type="html"><![CDATA[<h4 id="1-安装nodejs"><a href="#1-安装nodejs" class="headerlink" title="1. 安装nodejs"></a>1. 安装nodejs</h4><h4 id="2-安装git"><a href="#2-安装git" class="headerlink" title="2. 安装git"></a>2. 安装git</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y git-core</span><br></pre></td></tr></table></figure><h4 id="3-安装hexo"><a href="#3-安装hexo" class="headerlink" title="3. 安装hexo"></a>3. 安装hexo</h4><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>在<code>/home/xxx/</code>下新建<code>blog</code>的文件夹</p><p>依次执行以下命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p>启动hexo服务器，然后就可以通过localhost:4000访问了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure><h4 id="4-部署到GithubPages"><a href="#4-部署到GithubPages" class="headerlink" title="4. 部署到GithubPages"></a>4. 部署到GithubPages</h4><ol><li><p>创建 github账号</p></li><li><p>创建仓库，名为<code>&lt;Github账号名称&gt;.github.io</code></p></li><li><p>安装<code>hexo-deployer-git</code>插件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li><p>添加SSH Key， 回车三下即可，默认在当前用户的home目录下生成<code>.ssh/id_rsa</code>和<code>.ssh/id_rsa.pub</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>如果添加ssh key 过程中指定了存放路径，需要通过<code>ssh-add</code>命令把密钥加入ssh-agent的高速缓存里面</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-add &#x2F;home&#x2F;xxx&#x2F;id_rsa</span><br></pre></td></tr></table></figure><p>如果出现报错<code>Could not open a connection to your authentication agent.</code>，则先执行</p><p><code>ssh-agent bash --login -i</code></p><p>然后拷贝<code>/home/xxx/id_rsa.pub</code>的内容到github的<code>Settings</code>-<code>SSH and GPG Keys</code></p><p>验证是否添加成功，直到返回<code>You&#39;ve successfully authenticated</code></p></li></ol><pre><code> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;xxxx&quot;</span><br><span class="line">git config --global user.email &quot;xxx@gmail.com&quot;</span><br><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></code></pre><ol start="5"><li><p>修改hexo的配置文件，在<code>blog</code>目录下的<code>_config.yml</code>文件，在文本末尾添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:&lt;Github账号名称&gt;&#x2F;&lt;Github账号名称&gt;.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></li><li><p>推送到GithubPages</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g[generate]  &#x2F;&#x2F;Generate static files</span><br><span class="line">hexo d[deploy]    &#x2F;&#x2F;Deploy to remote sites</span><br></pre></td></tr></table></figure></li><li><p>稍等一会就可以通过<code>&lt;Github账号名称&gt;.github.io</code>访问了</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;1-安装nodejs&quot;&gt;&lt;a href=&quot;#1-安装nodejs&quot; class=&quot;headerlink&quot; title=&quot;1. 安装nodejs&quot;&gt;&lt;/a&gt;1. 安装nodejs&lt;/h4&gt;&lt;h4 id=&quot;2-安装git&quot;&gt;&lt;a href=&quot;#2-安装git&quot; class=&quot;headerlink&quot; title=&quot;2. 安装git&quot;&gt;&lt;/a&gt;2. 安装git&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install -y git-core&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;3-安装hexo&quot;&gt;&lt;a href=&quot;#3-安装hexo&quot; class=&quot;headerlink&quot; title=&quot;3. 安装hexo&quot;&gt;&lt;/a&gt;3. 安装hexo&lt;/h4&gt;</summary>
    
    
    
    
    <category term="hexo" scheme="https://www.forchanchan.cn/tags/hexo/"/>
    
  </entry>
  
</feed>
